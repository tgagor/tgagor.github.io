<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Maximizing page performance and security with Cloudflare tuning | Tom's Blog</title>
<meta name=keywords content="Cloudflare"><meta name=description content="Info
I use free tier of Cloudflare and all recommendations assume only those are available.
Why to cache statically generated blog? My Blog is statically gener"><meta name=author content="timor"><link rel=canonical href=https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/><link crossorigin=anonymous href=/assets/css/stylesheet.27832a74fc514252c1c862beee6260c5b11a6a764515b6f0739175258635baef.css integrity="sha256-J4MqdPxRQlLByGK+7mJgxbEaanZFFbbwc5F1JYY1uu8=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://gagor.pl/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://gagor.pl/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gagor.pl/favicon-32x32.png><link rel=apple-touch-icon href=https://gagor.pl/apple-touch-icon.png><link rel=mask-icon href=https://gagor.pl/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-4TQXK4C4W5"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4TQXK4C4W5",{anonymize_ip:!1})}</script><meta property="og:title" content="Maximizing page performance and security with Cloudflare tuning"><meta property="og:description" content="Info
I use free tier of Cloudflare and all recommendations assume only those are available.
Why to cache statically generated blog? My Blog is statically generated website served from Github Pages. As Github don&rsquo;t allow to easily set my own domain (at least in free version), I needed some kind of proxy that:
can server page from my domain, will provide valid certificate for HTTPS. Info
I know HTTPS for static site is a non-sense, but to keep it performant with HTTP/2 and HTTP/3 - you need it."><meta property="og:type" content="article"><meta property="og:url" content="https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/"><meta property="og:image" content="https://gagor.pl/images/cover.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-11T00:00:00+00:00"><meta property="article:modified_time" content="2024-01-11T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://gagor.pl/images/cover.webp"><meta name=twitter:title content="Maximizing page performance and security with Cloudflare tuning"><meta name=twitter:description content="Info
I use free tier of Cloudflare and all recommendations assume only those are available.
Why to cache statically generated blog? My Blog is statically generated website served from Github Pages. As Github don&rsquo;t allow to easily set my own domain (at least in free version), I needed some kind of proxy that:
can server page from my domain, will provide valid certificate for HTTPS. Info
I know HTTPS for static site is a non-sense, but to keep it performant with HTTP/2 and HTTP/3 - you need it."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://gagor.pl/posts/"},{"@type":"ListItem","position":3,"name":"Maximizing page performance and security with Cloudflare tuning","item":"https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Maximizing page performance and security with Cloudflare tuning","name":"Maximizing page performance and security with Cloudflare tuning","description":"Info\nI use free tier of Cloudflare and all recommendations assume only those are available.\nWhy to cache statically generated blog? My Blog is statically generated website served from Github Pages. As Github don\u0026rsquo;t allow to easily set my own domain (at least in free version), I needed some kind of proxy that:\ncan server page from my domain, will provide valid certificate for HTTPS. Info\nI know HTTPS for static site is a non-sense, but to keep it performant with HTTP/2 and HTTP/3 - you need it.","keywords":["Cloudflare"],"articleBody":" Info\nI use free tier of Cloudflare and all recommendations assume only those are available.\nWhy to cache statically generated blog? My Blog is statically generated website served from Github Pages. As Github don’t allow to easily set my own domain (at least in free version), I needed some kind of proxy that:\ncan server page from my domain, will provide valid certificate for HTTPS. Info\nI know HTTPS for static site is a non-sense, but to keep it performant with HTTP/2 and HTTP/3 - you need it.\nObviously, static site is pretty fast even with default Cloudflare configuration, but as I’m doing it for fun… let squeeze it 😄\nWhat Cloudflare can offer us? Cloudflare offers many options that can impact both security and performance of the website. I will go through the options I usually configure. Some of them can be easily turned on on any website, others will have more sense on rather static page.\nWarning\nPlease, don’t turn one everything at the same time.\nEnable, measure with Page Speed, SSL Server Test, then continue with another option.\nSSL/TLS tuning Security goes first 😄\nAlways Use HTTPS Turn it ON.\nI want it, you want it. It ensures all non encrypted requests will be redirected. Same could be achieved with a Page rule, but as you can only have 3 rules - you just save one.\nHTTPS is crucial for other optimization options to work.\nHTTP Strict Transport Security (HSTS) HTTP Strict Transport Security1 (HSTS, RFC 6797) is a header which allows a website to specify and enforce security policy in client web browsers. It makes no impact for the performance, but improves security and allows to get better grade in SSL Test 😄\nWarning\nOne critical consideration when using HSTS on Cloudflare is that once HSTS is turned on, your website must continue to have a valid HTTPS configuration conforming with the HSTS header to avoid making the website inaccessible to users!\nI have it enabled.\nMinimum TLS Version Default is TLS 1.0, which provides the best compatibility. I wanted to kick my score in SSL Test, so I bumped it to 1.2. Most modern browsers support it.\nOpportunistic Encryption We have a rule to redirect everything to HTTPS so this one is a no-op, but might be left enabled. TLS 1.3 Turn it ON.\nThis one is important. TLS 1.3 provides much faster initial connection and 0-RTT (check later).\nSpeed \\ Optimization \\ Content Optimization Brotli Turn it ON. It does what it says.\nCloudflare Fonts It optimize font loading times for custom fonts. I don’t have them, so I don’t care. If you use custom fonts, you can try it, but measure if there’s any difference.\nEarly Hints Turn it ON. Rocket Loader Play with it :) On one page it was resulting in faster load times, but on my blog it made load times actually higher.\nAuto Minify Play with it :) It minifies text files by removing spaces, etc. As it’s done on the fly, it can slow down page load times for the first time. Follow up request should be cached by Cloudflare.\nIn my case, I minify all the files during the content generation, so I just don’t need it.\\\nCaching \\ Configuration Caching Level You can play with two other options on dynamically generated pages to avoid caching dynamic content.\nFor static page, Standard is fine. Browser Cache TTL It’s first place where we can enforce strong caching of our page in the user’s browser. I don’t like this option because it treat all the type files the same.\nCrawler Hints It won’t impact your page performance, but allows Cloudflare to share some of your page access statistics with Bing (which shares data with DuckDuckGo too)\nM$ call this feature IndexNow.\nCaching \\ Cache Rules This is where the game starts!\nMost recommendations advice to configure Page rule and play around with Cache Level2 or Browser Cache TTL3 options. The problem is that in free version you can only have 3 rules and I already use one for redirection from HTTP to HTTPS.\nOther con of using Page rules is the way wildcard matching works there. It’s possible to use a star sign (*), to match multiple URLs. But to create rule matching image files like: JPG, JPEG, PNG, WEBP - I will need 4 rules. To handle CSS/JS and more, I will need even more. Dead end.\nWhat I wanted to achieve. My page don’t change too often\nAnd Github Pages sets cache TTL for images to only 10 days, it also do not set any cache for HTML/JS/CSS files. Github is quite reliable provider, but to improve world wide load times it’s nice to spread cache around the world and avoid requests to origin at all cost. Pages should be cached in the Cloudflare and served directly from there.\nMy target would be to:\ncache pages and static files in Cloudflare for 1 day, set browser cache for: HTML pages to 1 day CSS/JS to maybe 10-30 days (they don’t change frequently and each build provides new file) images of all sort 3-6 months (they don’t change at all, but are relatively big and it’s good to serve them from the edge locations) I found that Caching -\u003e Cache Rules options, which allow to better tune the way cache works in Cloudflare. Even more, I can add 10 rules for free and within those rules I can use OR operator to make single rule to match multiple patterns. Perfect!\nCaching images rule Let tackle image caching first.\nOn specific domain, go to Caching-\u003eCache rules Create a new Cache rule. Under When incoming requests match… add: Field: URI Path Operator: ends with Value: .webp add another rule and repeat for: .jpg, .jpeg, .png, .ico and whatever more you need Expression Preview should be showing: (ends_with(http.request.uri.path, \".webp\")) or (ends_with(http.request.uri.path, \".png\")) or (ends_with(http.request.uri.path, \".jpg\")) or (ends_with(http.request.uri.path, \".jpeg\")) or (ends_with(http.request.uri.path, \".ico\")) Under Then… block set Cache eligibility -\u003e Eligible for cache set Edge TTL -\u003e Ignore cache-control header and use this TTL under Input time-to-live (TTL) dropdown select 1 day (or more) set Browser TTL -\u003e Override origin and use this TTL under Input time-to-live (TTL) dropdown select 6 months (that’s minimal to make to stop https://pagespeed.web.dev/ from complaining) enable Serve stale content while revalidating Hit Deploy button Check my config below: What it does? Matching URI’s by extension should be clear, then we enable cache, which we want too. Now is the interesting part.\nEdge TTL - by setting this option, we enforce edge Cloudflare servers to ignore headers returned from Github pages and store matching responses for 1 day. I could probably go with 7 or 30 days, but if I eventually change any image I won’t need to purge cache. Cloudflare will just keep files for 1 day on it’s proxies and revalidate them next day. Browser TTL - above we configure “the server side” cache. Here we tell our users browsers how to treat files from our page. At least for images it makes sense to set pretty long caching time. Google’s Page Speed test stopped complaining about too short caching time after I set it up to 6 months. Serve stale content while revalidating - my page is static. Content changes infrequently and when it does, it’s not critical if change will became visible slightly later. But with this option enabled Cloudflare will server whatever he have in their cache and if it’s expired, then it will fetch it and update cache. What’s important - user don’t need to wait. This changes time to first byte from around 1~1.5s to 0.1s. Caching HTML/CSS/JS files Caching text files differs from images. With images you want to cache them for a long time as they don’t change. If they do, they change spectacularly, usually with the new URL.\nChanges to text documents happen more often, especially on a blog - small update, fixing some typos, etc. You want them to be visible fast. Not necessarily immediately, but fast.\nLet build another rule. With CSS and JS files it’s easy - we match the end of URI Path with their extensions. Done.\nWith HTML files it’s harder, because not all page URLs end with HTML extension. It’s also not possible to match rule by Content Type (which is such a pity). But we can match a Request Header. We can use Accept header as a hook, because when browsers request HTML files they usually do it like that:\nAccept: text/html, application/xhtml+xml, application/xml;q=0.9, image/webp, */*;q=0.8 We can then match Accept Request Header if it contains text/html - that would be quite probable HTML file 😄\nWarning\nI wouldn’t use it on any dynamically generated, production site without extensive testing. In my case a static site is safe to assume those are HTML files and nothing else.\nLet take a look how does it look completely: We can deploy the rule now.\nSummary Those are all options I use in the Cloudflare for my static pages. There are many more variations on the topic, like CLoudflare Pages which might be nice alternative to Github Pages and could further improve loading speed.\nIt’s good to have a small site or blog to play around before you will turn it all ON.\nUse services like:\nPage Speed SSL Server Test To verify the real impact of your changes. Having RUM monitoring might be even better.\nGood luck and sub zero loading times for your pages!\nhttps://developers.cloudflare.com/ssl/edge-certificates/additional-options/http-strict-transport-security/ ↩︎\nhttps://developers.cloudflare.com/rules/page-rules/reference/recommended-rules/#security-level-and-cache-level ↩︎\nhttps://developers.cloudflare.com/rules/page-rules/reference/recommended-rules/#edge-cache-ttl-and-browser-cache-ttl ↩︎\n","wordCount":"1585","inLanguage":"en","image":"https://gagor.pl/images/cover.webp","datePublished":"2024-01-11T00:00:00Z","dateModified":"2024-01-11T00:00:00Z","author":{"@type":"Person","name":"timor"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/"},"publisher":{"@type":"Organization","name":"Tom's Blog","logo":{"@type":"ImageObject","url":"https://gagor.pl/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://gagor.pl accesskey=h title="Tom's Blog (Alt + H)"><img src=https://gagor.pl/favicon-72x72.png alt aria-label=logo height=36>Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://gagor.pl/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://gagor.pl/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://gagor.pl/bookshelf/ title=Bookshelf><span>Bookshelf</span></a></li><li><a href=https://gagor.pl/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://gagor.pl/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://gagor.pl>Home</a>&nbsp;»&nbsp;<a href=https://gagor.pl/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Maximizing page performance and security with Cloudflare tuning</h1><div class=post-meta><span title='2024-01-11 00:00:00 +0000 UTC'>2024-01-11</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;timor</div></header><figure class=entry-cover><img loading=eager srcset="https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/images/cover_hu35c3b4bdc77b70a75d068105e77f0082_104810_360x0_resize_q75_h2_box_2.webp 360w ,https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/images/cover_hu35c3b4bdc77b70a75d068105e77f0082_104810_480x0_resize_q75_h2_box_2.webp 480w ,https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/images/cover_hu35c3b4bdc77b70a75d068105e77f0082_104810_720x0_resize_q75_h2_box_2.webp 720w ,https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/images/cover_hu35c3b4bdc77b70a75d068105e77f0082_104810_1080x0_resize_q75_h2_box_2.webp 1080w ,https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/images/cover_hu35c3b4bdc77b70a75d068105e77f0082_104810_1500x0_resize_q75_h2_box_2.webp 1500w ,https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/images/cover.webp 1500w" sizes="(min-width: 768px) 720px, 100vw" src=https://gagor.pl/2024/01/maximizing-page-performance-and-security-with-cloudflare-tuning/images/cover.webp alt=[Cloudflare](https://www.cloudflare.com) width=1500 height=625><p><a href=https://www.cloudflare.com>Cloudflare</a></p></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#why-to-cache-statically-generated-blog aria-label="Why to cache statically generated blog?">Why to cache statically generated blog?</a></li><li><a href=#what-cloudflare-can-offer-us aria-label="What Cloudflare can offer us?">What Cloudflare can offer us?</a></li><li><a href=#ssltls-tuning aria-label="SSL/TLS tuning">SSL/TLS tuning</a><ul><li><a href=#always-use-https aria-label="Always Use HTTPS">Always Use HTTPS</a></li><li><a href=#http-strict-transport-security-hsts aria-label="HTTP Strict Transport Security (HSTS)">HTTP Strict Transport Security (HSTS)</a></li><li><a href=#minimum-tls-version aria-label="Minimum TLS Version">Minimum TLS Version</a></li><li><a href=#opportunistic-encryption aria-label="Opportunistic Encryption">Opportunistic Encryption</a></li><li><a href=#tls-13 aria-label="TLS 1.3">TLS 1.3</a></li></ul></li><li><a href=#speed--optimization--content-optimization aria-label="Speed \ Optimization \ Content Optimization">Speed \ Optimization \ Content Optimization</a><ul><li><a href=#brotli aria-label=Brotli>Brotli</a></li><li><a href=#cloudflare-fonts aria-label="Cloudflare Fonts">Cloudflare Fonts</a></li><li><a href=#early-hints aria-label="Early Hints">Early Hints</a></li><li><a href=#rocket-loader aria-label="Rocket Loader">Rocket Loader</a></li><li><a href=#auto-minify aria-label="Auto Minify">Auto Minify</a></li></ul></li><li><a href=#caching--configuration aria-label="Caching \ Configuration">Caching \ Configuration</a><ul><li><a href=#caching-level aria-label="Caching Level">Caching Level</a></li><li><a href=#browser-cache-ttl aria-label="Browser Cache TTL">Browser Cache TTL</a></li><li><a href=#crawler-hints aria-label="Crawler Hints">Crawler Hints</a></li></ul></li><li><a href=#caching--cache-rules aria-label="Caching \ Cache Rules">Caching \ Cache Rules</a><ul><li><a href=#caching-images-rule aria-label="Caching images rule">Caching images rule</a></li><li><a href=#what-it-does aria-label="What it does?">What it does?</a></li><li><a href=#caching-htmlcssjs-files aria-label="Caching HTML/CSS/JS files">Caching HTML/CSS/JS files</a></li></ul></li><li><a href=#summary aria-label=Summary>Summary</a></li></ul></div></details></div><div class=post-content><style type=text/css>.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:#444;background:#e7f2fa}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:#fff;background:#6ab0de}.notice.warning .notice-title{background:rgba(217,83,79,.9)}.notice.warning{background:#fae2e2}.notice.info .notice-title{background:#f0b37e}.notice.info{background:#fff2db}.notice.note .notice-title{background:#6ab0de}.notice.note{background:#e7f2fa}.notice.tip .notice-title{background:rgba(92,184,92,.8)}.notice.tip{background:#e6f9e6}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}</style><div><svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg"><symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379.0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628.0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628.0l-22.627 22.627c-6.248 6.248-6.248 16.379.0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/></symbol><symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405.0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346 7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373.0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884.0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet"><path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937.0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154.0l239.94 416.028zM288 354c-25.405.0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346 7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373.0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884.0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196.0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627.0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627.0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627.0 12 5.373 12 12v1e2h12c6.627.0 12 5.373 12 12v24z"/></symbol></svg></div><div class="notice info"><p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#info-notice"/></svg></span>Info</p><p>I use free tier of Cloudflare and all recommendations assume only those are available.</p></div><h2 id=why-to-cache-statically-generated-blog>Why to cache statically generated blog?<a hidden class=anchor aria-hidden=true href=#why-to-cache-statically-generated-blog>#</a></h2><p>My Blog is statically generated website served from <a href=https://pages.github.com/>Github Pages</a>. As Github don&rsquo;t allow to easily set my own domain (at least in free version), I needed some kind of proxy that:</p><ul><li>can server page from my domain,</li><li>will provide valid certificate for HTTPS.</li></ul><div class="notice info"><p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#info-notice"/></svg></span>Info</p><p>I know HTTPS for static site is a non-sense, but to keep it performant with HTTP/2 and HTTP/3 - you need it.</p></div><p>Obviously, static site is pretty fast even with default Cloudflare configuration, but as I&rsquo;m doing it for fun&mldr; let squeeze it &#x1f604;</p><h2 id=what-cloudflare-can-offer-us>What Cloudflare can offer us?<a hidden class=anchor aria-hidden=true href=#what-cloudflare-can-offer-us>#</a></h2><p>Cloudflare offers many options that can impact both security and performance of the website. I will go through the options I usually configure. Some of them can be easily turned on on any website, others will have more sense on rather static page.</p><div class="notice warning"><p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"/></svg></span>Warning</p><p>Please, don&rsquo;t turn one everything at the same time.</p><p>Enable, measure with <a href=https://pagespeed.web.dev>Page Speed</a>, <a href=https://www.ssllabs.com/ssltest/analyze.html>SSL Server Test</a>, then continue with another option.</p></div><h2 id=ssltls-tuning>SSL/TLS tuning<a hidden class=anchor aria-hidden=true href=#ssltls-tuning>#</a></h2><p>Security goes first &#x1f604;</p><h3 id=always-use-https>Always Use HTTPS<a hidden class=anchor aria-hidden=true href=#always-use-https>#</a></h3><p>Turn it ON.</p><figure><img loading=lazy src=images/always-use-https.png></figure><p>I want it, you want it. It ensures all non encrypted requests will be redirected. Same could be achieved with a <strong>Page rule</strong>, but as you can only have 3 rules - you just save one.</p><p>HTTPS is crucial for other optimization options to work.</p><h3 id=http-strict-transport-security-hsts>HTTP Strict Transport Security (HSTS)<a hidden class=anchor aria-hidden=true href=#http-strict-transport-security-hsts>#</a></h3><p>HTTP Strict Transport Security<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> (HSTS, RFC 6797) is a header which allows a website to specify and enforce security policy in client web browsers.
It makes no impact for the performance, but improves security and allows to get better grade in <a href=https://www.ssllabs.com/ssltest/index.html>SSL Test</a> &#x1f604;</p><div class="notice warning"><p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"/></svg></span>Warning</p><p>One critical consideration when using HSTS on Cloudflare is that once HSTS is turned on, your website must continue to have a valid HTTPS configuration conforming with the HSTS header to avoid making the website inaccessible to users!</p></div><p>I have it enabled.</p><figure><img loading=lazy src=images/hsts.png></figure><h3 id=minimum-tls-version>Minimum TLS Version<a hidden class=anchor aria-hidden=true href=#minimum-tls-version>#</a></h3><p>Default is <code>TLS 1.0</code>, which provides the best compatibility. I wanted to kick my score in SSL Test, so I bumped it to 1.2. Most modern browsers support it.</p><figure><img loading=lazy src=images/min-tls-version.png></figure><h3 id=opportunistic-encryption>Opportunistic Encryption<a hidden class=anchor aria-hidden=true href=#opportunistic-encryption>#</a></h3><p>We have a rule to redirect everything to HTTPS so this one is a no-op, but might be left enabled.<figure><img loading=lazy src=images/opportunistic-encryption.png></figure></p><h3 id=tls-13>TLS 1.3<a hidden class=anchor aria-hidden=true href=#tls-13>#</a></h3><p>Turn it ON.</p><figure><img loading=lazy src=images/tls-1.3.png></figure><p>This one is important. TLS 1.3 provides much faster initial connection and 0-RTT (check later).</p><h2 id=speed--optimization--content-optimization>Speed \ Optimization \ Content Optimization<a hidden class=anchor aria-hidden=true href=#speed--optimization--content-optimization>#</a></h2><h3 id=brotli>Brotli<a hidden class=anchor aria-hidden=true href=#brotli>#</a></h3><p>Turn it ON.<figure><img loading=lazy src=images/brotli.png></figure>It does what it says.</p><h3 id=cloudflare-fonts>Cloudflare Fonts<a hidden class=anchor aria-hidden=true href=#cloudflare-fonts>#</a></h3><p>It optimize font loading times for custom fonts. I don&rsquo;t have them, so I don&rsquo;t care. If you use custom fonts, you can try it, but measure if there&rsquo;s any difference.</p><h3 id=early-hints>Early Hints<a hidden class=anchor aria-hidden=true href=#early-hints>#</a></h3><p>Turn it ON.<figure><img loading=lazy src=images/early-hints.png></figure></p><h3 id=rocket-loader>Rocket Loader<a hidden class=anchor aria-hidden=true href=#rocket-loader>#</a></h3><p>Play with it :)<figure><img loading=lazy src=images/rocket-loader.png></figure></p><p>On one page it was resulting in faster load times, but on my blog it made load times actually higher.</p><h3 id=auto-minify>Auto Minify<a hidden class=anchor aria-hidden=true href=#auto-minify>#</a></h3><p>Play with it :)<figure><img loading=lazy src=images/auto-minify.png></figure></p><p>It minifies text files by removing spaces, etc. As it&rsquo;s done on the fly, it can slow down page load times for the first time. Follow up request should be cached by Cloudflare.</p><p>In my case, I minify all the files during the content generation, so I just don&rsquo;t need it.\</p><h2 id=caching--configuration>Caching \ Configuration<a hidden class=anchor aria-hidden=true href=#caching--configuration>#</a></h2><h3 id=caching-level>Caching Level<a hidden class=anchor aria-hidden=true href=#caching-level>#</a></h3><p>You can play with two other options on dynamically generated pages to avoid caching dynamic content.</p><p>For static page, <strong>Standard</strong> is fine.<figure><img loading=lazy src=images/caching-level.png></figure></p><h3 id=browser-cache-ttl>Browser Cache TTL<a hidden class=anchor aria-hidden=true href=#browser-cache-ttl>#</a></h3><p>It&rsquo;s first place where we can enforce strong caching of our page in the user&rsquo;s browser. I don&rsquo;t like this option because it treat all the type files the same.</p><figure><img loading=lazy src=images/browser-cache-ttl.png></figure><h3 id=crawler-hints>Crawler Hints<a hidden class=anchor aria-hidden=true href=#crawler-hints>#</a></h3><p>It won&rsquo;t impact your page performance, but allows Cloudflare to share some of your page access statistics with Bing (which shares data with DuckDuckGo too)</p><figure><img loading=lazy src=images/crawler-hints.png></figure><p>M$ call this feature <a href=https://blogs.bing.com/webmaster/november-2021/Cloudflare-Supports-IndexNow-via-one-click-Integration><strong>IndexNow</strong></a>.</p><h2 id=caching--cache-rules>Caching \ Cache Rules<a hidden class=anchor aria-hidden=true href=#caching--cache-rules>#</a></h2><p>This is where the game starts!</p><p>Most recommendations advice to configure <strong>Page rule</strong> and play around with <strong>Cache Level</strong><sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> or <strong>Browser Cache TTL</strong><sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> options. The problem is that in free version you can only have <strong>3 rules</strong> and I already use one for redirection from HTTP to HTTPS.</p><p>Other con of using <strong>Page rules</strong> is the way wildcard matching works there. It&rsquo;s possible to use a star sign (<code>*</code>), to match multiple URLs. But to create rule matching image files like: JPG, JPEG, PNG, WEBP - I will need 4 rules. To handle CSS/JS and more, I will need even more. Dead end.</p><p>What I wanted to achieve. My page don&rsquo;t change too often</p><p>And Github Pages sets cache TTL for images to only 10 days, it also do not set any cache for HTML/JS/CSS files. Github is quite reliable provider, but to improve world wide load times it&rsquo;s nice to spread cache around the world and avoid requests to origin at all cost. Pages should be cached in the Cloudflare and served directly from there.</p><p>My target would be to:</p><ul><li>cache pages and static files in Cloudflare for 1 day,</li><li>set browser cache for:<ul><li>HTML pages to 1 day</li><li>CSS/JS to maybe 10-30 days (they don&rsquo;t change frequently and each build provides new file)</li><li>images of all sort 3-6 months (they don&rsquo;t change at all, but are relatively big and it&rsquo;s good to serve them from the edge locations)</li></ul></li></ul><p>I found that <code>Caching</code> -> <code>Cache Rules</code> options, which allow to better tune the way cache works in Cloudflare. Even more, I can add 10 rules for free and within those rules I can use <code>OR</code> operator to make single rule to match multiple patterns. Perfect!</p><h3 id=caching-images-rule>Caching images rule<a hidden class=anchor aria-hidden=true href=#caching-images-rule>#</a></h3><p>Let tackle image caching first.</p><ul><li>On specific domain, go to <code>Caching</code>-><code>Cache rules</code> Create a new <code>Cache rule</code>.</li><li>Under <strong>When incoming requests match…</strong> add:<ul><li>Field: <code>URI Path</code></li><li>Operator: <code>ends with</code></li><li>Value: <code>.webp</code></li><li>add another rule and repeat for: <code>.jpg</code>, <code>.jpeg</code>, <code>.png</code>, <code>.ico</code> and whatever more you need</li></ul></li><li>Expression Preview should be showing:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>(ends_with(http.request.uri.path, &#34;.webp&#34;)) or (ends_with(http.request.uri.path, &#34;.png&#34;)) or (ends_with(http.request.uri.path, &#34;.jpg&#34;)) or (ends_with(http.request.uri.path, &#34;.jpeg&#34;)) or (ends_with(http.request.uri.path, &#34;.ico&#34;))
</span></span></code></pre></div></li><li>Under <strong>Then&mldr;</strong> block<ul><li>set <strong>Cache eligibility</strong> -> <strong>Eligible for cache</strong></li><li>set <strong>Edge TTL</strong> -> <strong>Ignore cache-control header and use this TTL</strong><ul><li>under <strong>Input time-to-live (TTL)</strong> dropdown select <strong>1 day</strong> (or more)</li></ul></li><li>set <strong>Browser TTL</strong> -> <strong>Override origin and use this TTL</strong><ul><li>under <strong>Input time-to-live (TTL)</strong> dropdown select <strong>6 months</strong> (that&rsquo;s minimal to make to stop <a href=https://pagespeed.web.dev/>https://pagespeed.web.dev/</a> from complaining)</li></ul></li><li>enable <strong>Serve stale content while revalidating</strong></li></ul></li><li>Hit <strong>Deploy</strong> button</li></ul><p>Check my config below:<figure><img loading=lazy src=images/cache-rule-images.png></figure></p><h3 id=what-it-does>What it does?<a hidden class=anchor aria-hidden=true href=#what-it-does>#</a></h3><p>Matching URI&rsquo;s by extension should be clear, then we enable cache, which we want too. Now is the interesting part.</p><ul><li><strong>Edge TTL</strong> - by setting this option, we enforce edge Cloudflare servers to ignore headers returned from Github pages and store matching responses for 1 day. I could probably go with 7 or 30 days, but if I eventually change any image I won&rsquo;t need to purge cache. Cloudflare will just keep files for 1 day on it&rsquo;s proxies and revalidate them next day.</li><li><strong>Browser TTL</strong> - above we configure &ldquo;the server side&rdquo; cache. Here we tell our users browsers how to treat files from our page. At least for images it makes sense to set pretty long caching time. Google&rsquo;s Page Speed test stopped complaining about too short caching time after I set it up to 6 months.</li><li><strong>Serve stale content while revalidating</strong> - my page is static. Content changes infrequently and when it does, it&rsquo;s not critical if change will became visible slightly later. But with this option enabled Cloudflare will server whatever he have in their cache and if it&rsquo;s expired, then it will fetch it and update cache. What&rsquo;s important - user don&rsquo;t need to wait. This changes time to first byte from around 1~1.5s to 0.1s.</li></ul><h3 id=caching-htmlcssjs-files>Caching HTML/CSS/JS files<a hidden class=anchor aria-hidden=true href=#caching-htmlcssjs-files>#</a></h3><p>Caching text files differs from images. With images you want to cache them for a long time as they don&rsquo;t change. If they do, they change spectacularly, usually with the new URL.</p><p>Changes to text documents happen more often, especially on a blog - small update, fixing some typos, etc. You want them to be visible fast. Not necessarily immediately, but fast.</p><p>Let build another rule. With CSS and JS files it&rsquo;s easy - we match the end of <code>URI Path</code> with their extensions. Done.</p><p>With HTML files it&rsquo;s harder, because not all page URLs end with HTML extension. It&rsquo;s also not possible to match rule by Content Type (which is such a pity). But we can match a <code>Request Header</code>. We can use <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept><code>Accept</code> header</a> as a hook, because when browsers request HTML files they usually do it like that:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Accept: text/html, application/xhtml+xml, application/xml;q=0.9, image/webp, */*;q=0.8
</span></span></code></pre></div><p>We can then match <code>Accept</code> <code>Request Header</code> if it contains <code>text/html</code> - that would be quite probable HTML file &#x1f604;</p><div class="notice warning"><p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"/></svg></span>Warning</p><p>I wouldn&rsquo;t use it on any dynamically generated, production site without extensive testing. In my case a static site is safe to assume those are HTML files and nothing else.</p></div><p>Let take a look how does it look completely:<figure><img loading=lazy src=images/cache-rule-text-files.png></figure></p><p>We can deploy the rule now.</p><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p>Those are all options I use in the Cloudflare for my static pages. There are many more variations on the topic, like <a href=https://pages.cloudflare.com>CLoudflare Pages</a> which might be nice alternative to Github Pages and could further improve loading speed.</p><p>It&rsquo;s good to have a small site or blog to play around before you will turn it all ON.</p><p>Use services like:</p><ul><li><a href=https://pagespeed.web.dev>Page Speed</a></li><li><a href=https://www.ssllabs.com/ssltest/analyze.html>SSL Server Test</a></li></ul><p>To verify the real impact of your changes. Having <a href=https://en.wikipedia.org/wiki/Real_user_monitoring>RUM monitoring</a> might be even better.</p><p>Good luck and sub zero loading times for your pages!</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://developers.cloudflare.com/ssl/edge-certificates/additional-options/http-strict-transport-security/>https://developers.cloudflare.com/ssl/edge-certificates/additional-options/http-strict-transport-security/</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://developers.cloudflare.com/rules/page-rules/reference/recommended-rules/#security-level-and-cache-level>https://developers.cloudflare.com/rules/page-rules/reference/recommended-rules/#security-level-and-cache-level</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://developers.cloudflare.com/rules/page-rules/reference/recommended-rules/#edge-cache-ttl-and-browser-cache-ttl>https://developers.cloudflare.com/rules/page-rules/reference/recommended-rules/#edge-cache-ttl-and-browser-cache-ttl</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://gagor.pl/tags/cloudflare/>Cloudflare</a></li></ul><nav class=paginav><a class=prev href=https://gagor.pl/2024/01/%C5%82adne-kwiatki-czyli-wywod-o-pielegnacji-roslin-doniczkowych/><span class=title>« Prev</span><br><span>Ładne kwiatki - czyli wywód o pielęgnacji roślin doniczkowych</span>
</a><a class=next href=https://gagor.pl/2024/01/new-years-reflections-and-leadership-path/><span class=title>Next »</span><br><span>New Year's reflections and Leadership path</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Maximizing page performance and security with Cloudflare tuning on x" href="https://x.com/intent/tweet/?text=Maximizing%20page%20performance%20and%20security%20with%20Cloudflare%20tuning&amp;url=https%3a%2f%2fgagor.pl%2f2024%2f01%2fmaximizing-page-performance-and-security-with-cloudflare-tuning%2f&amp;hashtags=Cloudflare"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Maximizing page performance and security with Cloudflare tuning on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fgagor.pl%2f2024%2f01%2fmaximizing-page-performance-and-security-with-cloudflare-tuning%2f&amp;title=Maximizing%20page%20performance%20and%20security%20with%20Cloudflare%20tuning&amp;summary=Maximizing%20page%20performance%20and%20security%20with%20Cloudflare%20tuning&amp;source=https%3a%2f%2fgagor.pl%2f2024%2f01%2fmaximizing-page-performance-and-security-with-cloudflare-tuning%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Maximizing page performance and security with Cloudflare tuning on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgagor.pl%2f2024%2f01%2fmaximizing-page-performance-and-security-with-cloudflare-tuning%2f&title=Maximizing%20page%20performance%20and%20security%20with%20Cloudflare%20tuning"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Maximizing page performance and security with Cloudflare tuning on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgagor.pl%2f2024%2f01%2fmaximizing-page-performance-and-security-with-cloudflare-tuning%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Maximizing page performance and security with Cloudflare tuning on whatsapp" href="https://api.whatsapp.com/send?text=Maximizing%20page%20performance%20and%20security%20with%20Cloudflare%20tuning%20-%20https%3a%2f%2fgagor.pl%2f2024%2f01%2fmaximizing-page-performance-and-security-with-cloudflare-tuning%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Maximizing page performance and security with Cloudflare tuning on telegram" href="https://telegram.me/share/url?text=Maximizing%20page%20performance%20and%20security%20with%20Cloudflare%20tuning&amp;url=https%3a%2f%2fgagor.pl%2f2024%2f01%2fmaximizing-page-performance-and-security-with-cloudflare-tuning%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Maximizing page performance and security with Cloudflare tuning on ycombinator" href="https://news.ycombinator.com/submitlink?t=Maximizing%20page%20performance%20and%20security%20with%20Cloudflare%20tuning&u=https%3a%2f%2fgagor.pl%2f2024%2f01%2fmaximizing-page-performance-and-security-with-cloudflare-tuning%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://utteranc.es/client.js repo=tgagor/tgagor.github.io issue-term=pathname theme=photon-dark crossorigin=anonymous async></script></article></main><footer class=footer><span><a href=https://gagor.pl>Tom's Blog</a> &copy; 2008-2024</span>
<span>Content licensed under <a rel="license noopener noreferrer" target=_blank href=http://creativecommons.org/licenses/by-sa/4.0/>(CC BY-SA 4.0)</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>