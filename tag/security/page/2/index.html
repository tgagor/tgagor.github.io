<!doctype html><html lang=en dir=auto data-theme=dark><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Security | Tom's Blog</title><meta name=keywords content><meta name=description content="pages for taxonomy (classification) term: security"><meta name=author content="Tom"><link rel=canonical href=https://gagor.pro/tag/security/><link crossorigin=anonymous href=/assets/css/stylesheet.39842b47ddad10fd3b178d241a761469c699eb9463169f8fb2846d409377dde1.css integrity="sha256-OYQrR92tEP07F40kGnYUacaZ65RjFp+PsoRtQJN33eE=" rel="preload stylesheet" as=style><link rel=icon href=https://gagor.pro/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://gagor.pro/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gagor.pro/favicon-32x32.png><link rel=apple-touch-icon href=https://gagor.pro/apple-touch-icon.png><link rel=mask-icon href=https://gagor.pro/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://gagor.pro/tag/security/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><link rel=webmention href=https://webmention.io/gagor.pro/webmention><link rel=pingback href=https://webmention.io/gagor.pro/xmlrpc><meta name=fediverse:creator content="@tgagor@mastodon.social"><link rel=me href=https://mastodon.social/@tgagor><meta property="og:url" content="https://gagor.pro/tag/security/"><meta property="og:site_name" content="Tom's Blog"><meta property="og:title" content="Security"><meta property="og:description" content="DevOps blog exploring Linux configuration, containerization, automation, security, and leadership insights, plus a curated bookshelf for IT pros."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Security"><meta name=twitter:description content="DevOps blog exploring Linux configuration, containerization, automation, security, and leadership insights, plus a curated bookshelf for IT pros."></head><body class=list id=top><header class=header><nav class=nav><div class=logo><a href=https://gagor.pro/ accesskey=h title="Tom's Blog (Alt + H)"><img src=https://gagor.pro/favicon-36x36.avif alt="Page logo" aria-label=logo height=36 width=36>Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://gagor.pro/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://gagor.pro/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://gagor.pro/bookshelf/ title=Bookshelf><span>Bookshelf</span></a></li><li><a href=https://gagor.pro/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://gagor.pro/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://gagor.pro/>Home</a>&nbsp;»&nbsp;<a href=https://gagor.pro/tags/>Tags</a></div><h1>Security</h1></header><article class="post-entry tag-entry"><figure class=entry-cover><img class=u-photo loading=lazy srcset='https://gagor.pro/book/2016/sztuka-podstepu/images/book-cover_hu_85b5dc2117480cdd.webp 360w,https://gagor.pro/book/2016/sztuka-podstepu/images/book-cover_hu_c087698234c51c20.webp 480w,https://gagor.pro/book/2016/sztuka-podstepu/images/book-cover.webp 625w' src=https://gagor.pro/book/2016/sztuka-podstepu/images/book-cover.webp sizes="(min-width: 768px) 720px, 100vw" width=625 height=893 alt="Cover of Sztuka podstępu book"></figure><header class=entry-header><h2 class=entry-hint-parent>Sztuka podstępu</h2></header><div class=entry-content><p>Sztuka podstępuŁamałem ludzi, nie hasła
Authors: Kevin Mitnick, William L. Simon</p></div><footer class=entry-footer><span title='2016-02-10 00:00:00 +0000 UTC' class=dt-published>2016-02-10</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span class='p-author h-card'>Tom<img class=u-photo src=https://gagor.pro/author/tom/avatar.avif alt=Tom style=display:none hidden></span></footer><a class=entry-link aria-label="post link to Sztuka podstępu" href=https://gagor.pro/book/2016/sztuka-podstepu/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img class=u-photo loading=lazy src=https://gagor.pro/generic-cover.webp alt="[Photo by Tima Miroshnichenko](https://www.pexels.com/photo/close-up-view-of-system-hacking-in-a-monitor-5380664/)"></figure><header class=entry-header><h2 class=entry-hint-parent>Prepare for DoS like Cloudflare do</h2></header><div class=entry-content><p>I watched nice presentation about how Cloudflare protects itself against DoS. Most of us are not able to do that exactly like them but some of tips were general enough to be used on typical web front server.
I took notes from this presentation and presented here. Thanks to Marek agreement I also reposted all examples (in easier to copy paste way).
Howto prepare against ACK/FIN/RST/X-mas flood Use conntrack rule:
...</p></div><footer class=entry-footer><span title='2016-02-05 00:00:00 +0000 UTC' class=dt-published>2016-02-05</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span class='p-author h-card'>Tom<img class=u-photo src=https://gagor.pro/author/tom/avatar.avif alt=Tom style=display:none hidden></span></footer><a class=entry-link aria-label="post link to Prepare for DoS like Cloudflare do" href=https://gagor.pro/2016/02/prepare-for-dos-like-cloudflare-do/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img class=u-photo loading=lazy src=https://gagor.pro/generic-cover.webp alt="[Photo by Tima Miroshnichenko](https://www.pexels.com/photo/close-up-view-of-system-hacking-in-a-monitor-5380664/)"></figure><header class=entry-header><h2 class=entry-hint-parent>Let’s Encrypt - without auto configuration</h2></header><div class=entry-content><p>From the first moment I heard about Let’s Encrypt I liked it and wanted to use it as fast as possible. But the more I read how they want to implement it, the more I dislike it.
Current project with automatic configuration is not what I want to use at all. I have many very complicated configs and I do not trust such tools enough to use them. I like UNIX’s single purpose principle, tools should do one thing and do it well - nothing more.
...</p></div><footer class=entry-footer><span title='2016-01-04 00:00:00 +0000 UTC' class=dt-published>2016-01-04</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span class='p-author h-card'>Tom<img class=u-photo src=https://gagor.pro/author/tom/avatar.avif alt=Tom style=display:none hidden></span></footer><a class=entry-link aria-label="post link to Let’s Encrypt - without auto configuration" href=https://gagor.pro/2016/01/lets-encrypt-without-auto-configuration/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img class=u-photo loading=lazy srcset='https://gagor.pro/book/2015/splatana-siec/images/book-cover_hu_d110cf85f3440d7e.webp 360w,https://gagor.pro/book/2015/splatana-siec/images/book-cover_hu_db3cce9c407287af.webp 480w,https://gagor.pro/book/2015/splatana-siec/images/book-cover.webp 625w' src=https://gagor.pro/book/2015/splatana-siec/images/book-cover.webp sizes="(min-width: 768px) 720px, 100vw" width=625 height=893 alt="Cover of Splątana sieć book"></figure><header class=entry-header><h2 class=entry-hint-parent>Splątana sieć</h2></header><div class=entry-content><p>Splątana siećPrzewodnik po bezpieczeństwie nowoczesnych aplikacji WWW
Author: Michał Zalewski</p></div><footer class=entry-footer><span title='2015-12-10 00:00:00 +0000 UTC' class=dt-published>2015-12-10</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span class='p-author h-card'>Tom<img class=u-photo src=https://gagor.pro/author/tom/avatar.avif alt=Tom style=display:none hidden></span></footer><a class=entry-link aria-label="post link to Splątana sieć" href=https://gagor.pro/book/2015/splatana-siec/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img class=u-photo loading=lazy src=https://gagor.pro/generic-cover.webp alt="[Photo by Tima Miroshnichenko](https://www.pexels.com/photo/close-up-view-of-system-hacking-in-a-monitor-5380664/)"></figure><header class=entry-header><h2 class=entry-hint-parent>Generate ECDSA key with OpenSSL</h2></header><div class=entry-content><p>After the last NSA scandal I’ve found some time to read some texts about PFS and ECDSA keys lately. I always used RSA keys but wanted to give a try to ECDSA so I wanted to give it a try (test performance, etc). Here is how I’ve done it.
Firstly find your favorite curve. A short tip about bit length and complexity could be found here. From it you will now that using 256 bit ECDSA key should be enough for next 10-20 years.
...</p></div><footer class=entry-footer><span title='2013-12-17 00:00:00 +0000 UTC' class=dt-published>2013-12-17</span>&nbsp;·&nbsp;<span>5 min</span>&nbsp;·&nbsp;<span class='p-author h-card'>Tom<img class=u-photo src=https://gagor.pro/author/tom/avatar.avif alt=Tom style=display:none hidden></span></footer><a class=entry-link aria-label="post link to Generate ECDSA key with OpenSSL" href=https://gagor.pro/2013/12/generate-ecdsa-key-with-openssl/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img class=u-photo loading=lazy src=https://gagor.pro/generic-cover.webp alt="[Photo by Tima Miroshnichenko](https://www.pexels.com/photo/close-up-view-of-system-hacking-in-a-monitor-5380664/)"></figure><header class=entry-header><h2 class=entry-hint-parent>Running Apache with mod_spdy and PHP-FPM</h2></header><div class=entry-content><p>SPDY is new protocol proposed by Google as an alternative for HTTP(S). Currently Chrome and Firefox browsers are using it as default if available on server. It is faster in most cases by few to several percent. The side effect of using mod_spdy  external link is that it’s working well only with thread safe Apache’s modules. PHP module for Apache is not thread safe so we need to use PHP as CGI or FastCGI service. CGI is slow - so running mod_spdy for performance gain with CGI is simply pointless. FastCGI is better but it’s not possible to share APC  external link cache in FastCGI mode (ex. using spawn-fcgi), so it’s poor too. Best for PHP is PHP-FPM  external link which is FastCGI service with dynamic process manager and could use full advantages of APC. In such configuration I could switch from apache prefork to worker which should use less resources and be more predictable.
...</p></div><footer class=entry-footer><span title='2013-12-16 00:00:00 +0000 UTC' class=dt-published>2013-12-16</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span class='p-author h-card'>Tom<img class=u-photo src=https://gagor.pro/author/tom/avatar.avif alt=Tom style=display:none hidden></span></footer><a class=entry-link aria-label="post link to Running Apache with mod_spdy and PHP-FPM" href=https://gagor.pro/2013/12/running-apache-with-mod_spdy-and-php-fpm/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img class=u-photo loading=lazy src=https://gagor.pro/generic-cover.webp alt="[Photo by Tima Miroshnichenko](https://www.pexels.com/photo/close-up-view-of-system-hacking-in-a-monitor-5380664/)"></figure><header class=entry-header><h2 class=entry-hint-parent>Fortigate - VPN IPSec PSK XAuth z Android’a 4.x</h2></header><div class=entry-content><p>Do niedawna na moim telefonie VPN’ami były: PPTP lub L2TP - oba niespecjalnie mi się podobały. Ale od wersji 4-tej pojawiły się dwa nowe tryby: IPSec Xauth PSK i IPSec Xauth RSA. W pierwszym autoryzacja wykorzystuje login i hasło, w drugim certyfikaty.
Tryb IPSec Xauth PSK jest bardzo wygodny bo łatwo można połączyć go z zewnętrznymi mechanizmami uwierzytelniającymi np. LDAP, Active Directory, itp.
Pokażę jak skonfigurować swojego Fortigate’a by umożliwić połączenie z telefonów i tabletów na Androidzie 4.x do “Intranetu”1. Większość konfiguracji można przeprowadzić tylko w trybie CLI - zakładam że wiesz jak to zrobić. To co wygodniej można zrobić w trybie WWW to głównie tworzenie reguł dostępu na zaporze.
...</p></div><footer class=entry-footer><span title='2013-03-30 00:00:00 +0000 UTC' class=dt-published>2013-03-30</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span class='p-author h-card'>Tom<img class=u-photo src=https://gagor.pro/author/tom/avatar.avif alt=Tom style=display:none hidden></span></footer><a class=entry-link aria-label="post link to Fortigate - VPN IPSec PSK XAuth z Android’a 4.x" href=https://gagor.pro/2013/03/fortigate-vpn-ipsec-psk-xauth-z-androida-4-x/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img class=u-photo loading=lazy src=https://gagor.pro/generic-cover.webp alt="[Photo by Tima Miroshnichenko](https://www.pexels.com/photo/close-up-view-of-system-hacking-in-a-monitor-5380664/)"></figure><header class=entry-header><h2 class=entry-hint-parent>Nginx - hide server version and name in Server header and error pages</h2></header><div class=entry-content><p>On Debian you have to install nginx-extras package (because it have built in headers_more  external link module). Then you need two options (best in global configuration /etc/nginx/nginx.conf file, http part):
server_tokens off; more_set_headers 'Server: BadAss'; And it’s good to setup non standard error pages on every site (500 and 404 at minimum):
error_page 403 404 http://mysite.com/areyoulost; error_page 502 503 504 /500.html;</p></div><footer class=entry-footer><span title='2013-01-24 00:00:00 +0000 UTC' class=dt-published>2013-01-24</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span class='p-author h-card'>Tom<img class=u-photo src=https://gagor.pro/author/tom/avatar.avif alt=Tom style=display:none hidden></span></footer><a class=entry-link aria-label="post link to Nginx - hide server version and name in Server header and error pages" href=https://gagor.pro/2013/01/nginx-hide-server-version-and-name-in-server-header-and-error-pages/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img class=u-photo loading=lazy src=https://gagor.pro/generic-cover.webp alt="[Photo by Tima Miroshnichenko](https://www.pexels.com/photo/close-up-view-of-system-hacking-in-a-monitor-5380664/)"></figure><header class=entry-header><h2 class=entry-hint-parent>Hybrid Rainbow DB</h2></header><div class=entry-content><p>Jakiś czas temu napisałem swoją własną tęczową tablicę i odkąd zainteresowałem się tym tematem zastanawiałem się jak jeszcze bardziej usprawnić tę aplikację. Testowałem różne długości łańcuchów i zauważyłem że zwiększanie długości łańcucha bardzo szybko powoduje znaczne zwiększenie ilości kolizji, co drastycznie obniżało wydajność (nie wspominając o czasie potrzebnym na wygenerowanie całej tablicy). Z tego powodu ostateczna implementacja choć była rzeczywiście tęczową tablicą działała bardziej jak tablica hashy - bo łańcuchy były bardzo krótkie. Ponadto ze statystyk wynikało że bardzo rzadko hasła były odzyskiwane ze środka łańcucha - zdecydowana większość trafień pochodziła z pierwszego hasła w łańcuchu. Pierwsze hasło było przeważnie słownikowe, plus czasem jakiś dodatek w postaci cyfry/zmienionej wielkości liter, itp. Pozostałe hasła w łańcuchu były praktycznie losowe.
...</p></div><footer class=entry-footer><span title='2012-11-07 00:00:00 +0000 UTC' class=dt-published>2012-11-07</span>&nbsp;·&nbsp;<span>5 min</span>&nbsp;·&nbsp;<span class='p-author h-card'>Tom<img class=u-photo src=https://gagor.pro/author/tom/avatar.avif alt=Tom style=display:none hidden></span></footer><a class=entry-link aria-label="post link to Hybrid Rainbow DB" href=https://gagor.pro/2012/11/hybrid-rainbow-db/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img class=u-photo loading=lazy src=https://gagor.pro/generic-cover.webp alt="[Photo by Tima Miroshnichenko](https://www.pexels.com/photo/close-up-view-of-system-hacking-in-a-monitor-5380664/)"></figure><header class=entry-header><h2 class=entry-hint-parent>Apache: ograniczenie dostępu dla zalogowanych użytkowników z mod_rewrite i mod_auth_basic</h2></header><div class=entry-content><p>Niedawno trafiłem na ciekawy problem w mod_rewrite - by przekierowywać użytkowników logujących się jednym z modułów mod_auth_basic do dedykowanych im katalogów, równocześnie blokując dostęp do katalogów innych użytkowników. Nie brzmi to jakoś strasznie ale problem okazał się być całkiem nietrywialnym. Teoretyczne rozwiązanie sprowadzało się do wyszukania loginu użytkownika ze ścieżki URI i porównania z nazwą użytkownika ze zmiennej %{REMOTE_USER} - jeśli wartości się różnią to Forbidden. Ale szybko okazało się że w RewriteCond zmienne z dopasowań można podstawiać tylko w pierwszym parametrze i że o ile można RewriteCond’y połączyć wyrażeniami logicznymi typu AND/OR to nie ma możliwości porównania czy dopasowania z kolejnych RewriteCond’ów są identyczne. Po kilku dniach szperania w dokumentacji i różnych tutorialach udało mi się trafić na jedną wartościową wskazówkę ale tej stronki już nie ma, więc opiszę problem dla potomnych.
...</p></div><footer class=entry-footer><span title='2012-09-09 00:00:00 +0000 UTC' class=dt-published>2012-09-09</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span class='p-author h-card'>Tom<img class=u-photo src=https://gagor.pro/author/tom/avatar.avif alt=Tom style=display:none hidden></span></footer><a class=entry-link aria-label="post link to Apache: ograniczenie dostępu dla zalogowanych użytkowników z mod_rewrite i mod_auth_basic" href=https://gagor.pro/2012/09/apache-ograniczenie-dostepu-dla-zalogowanych-uzytkownikow-z-mod_rewrite-i-mod_auth_basic/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://gagor.pro/tag/security/>«&nbsp;Prev&nbsp;
</a><a class=next href=https://gagor.pro/tag/security/page/3/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span><a href=https://gagor.pro/>Tom's Blog</a> &copy; 2008-2026</span>
<span>Content licensed under <a rel="license noopener noreferrer" target=_blank href=https://creativecommons.org/licenses/by-sa/4.0/>(CC BY-SA 4.0)</a></span></footer><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "8d51d5292abd4c77bad90db038659671"}'></script><script defer src=https://analytics.ahrefs.com/analytics.js data-key=ngiuUolR4+T0MnN5eV7I/A async></script><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>