<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Tip | timor's site</title><meta name=keywords content><meta name=description content="pages for taxonomy (classification) term: tip"><meta name=author content><link rel=canonical href=https://gagor.pl/categories/tip/><link crossorigin=anonymous href=/assets/css/stylesheet.be84a2f064c7e93ecbe786e77620b732b98cf3f8ea42d8b36e32b9e585266d79.css integrity="sha256-voSi8GTH6T7L54bndiC3MrmM8/jqQtizbjK55YUmbXk=" rel="preload stylesheet" as=style><link rel=icon href=https://gagor.pl/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://gagor.pl/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gagor.pl/favicon-32x32.png><link rel=apple-touch-icon href=https://gagor.pl/apple-touch-icon.png><link rel=mask-icon href=https://gagor.pl/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://gagor.pl/categories/tip/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-4F5GDSK0NP"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4F5GDSK0NP",{anonymize_ip:!1})}</script><meta property="og:title" content="Tip"><meta property="og:description" content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"><meta property="og:type" content="website"><meta property="og:url" content="https://gagor.pl/categories/tip/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tip"><meta name=twitter:description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://gagor.pl accesskey=h title="timor's site (Alt + H)"><img src=https://gagor.pl/favicon-72x72.png alt aria-label=logo height=36>timor's site</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://gagor.pl/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://gagor.pl/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://gagor.pl/bookshelf/ title=Bookshelf><span>Bookshelf</span></a></li><li><a href=https://gagor.pl/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://gagor.pl/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://gagor.pl/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://gagor.pl>Home</a>&nbsp;»&nbsp;<a href=https://gagor.pl/categories/>Categories</a></div><h1>Tip</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>Some useful commands in Docker</h2></header><div class=entry-content><p>I started playing with Docker and here I will write some commands that where not so obvious at beginning 😃
List running containers:
docker ps List also not running containers:
docker ps -a Remove all containers (be careful with that):
docker rm $(docker ps -a -q) Remove all images:
docker rmi $(docker images -q) Docker won’t remove any old volumes used by containers, so after some time you may be interested in deleting them all:...</p></div><footer class=entry-footer><span title='2016-02-11 00:00:00 +0000 UTC'>2016-02-11</span>&nbsp;·&nbsp;1 min</footer><a class=entry-link aria-label="post link to Some useful commands in Docker" href=https://gagor.pl/2016/02/some-useful-commands-in-docker/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Mass replace in WordPress posts via MySQL query</h2></header><div class=entry-content><p>I was doing a lot of changes to my old posts, switched to HTTPS, etc. Sometimes it was useful to change some particular text in all my old posts at a time, but there is no such feature in WordPress. But WordPress runs on MySQL and I could use SQL query to update such posts.
Make backup - it’s not required but strongly advised 😃
Now use this query as template to replace in place whatever you need:
...</p></div><footer class=entry-footer><span title='2016-02-09 00:00:00 +0000 UTC'>2016-02-09</span>&nbsp;·&nbsp;1 min</footer><a class=entry-link aria-label="post link to Mass replace in WordPress posts via MySQL query" href=https://gagor.pl/2016/02/mass-replace-in-wordpress-posts-via-mysql-query/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Use www.horizon.tv with Pipelight/Silverlight on Linux/Ubuntu</h2></header><div class=entry-content><p>From few days I have access to UPC’s www.horizon.tv platform - until now it was useless on Linux. But there is Pipelight that will use Wine to emulate Silverlight on Linux and it’s working pretty well - you’re just few commands away from achieving that:
# stop browser killall firefox # remove old version if you have it sudo apt-get remove pipelight Now configure repos and install packages:
sudo apt-add-repository ppa:pipelight/stable sudo apt-get update sudo apt-get install --install-recommends pipelight-multi sudo pipelight-plugin --update Enable plugin (run it with sudo for system wide installation):...</p></div><footer class=entry-footer><span title='2016-02-09 00:00:00 +0000 UTC'>2016-02-09</span>&nbsp;·&nbsp;1 min</footer><a class=entry-link aria-label="post link to Use www.horizon.tv with Pipelight/Silverlight on Linux/Ubuntu" href=https://gagor.pl/2016/02/use-www-horizon-tv-with-pipelight-silverlight-on-linux-ubuntu/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Zeitgeist activity.sqlite-wal getting huge</h2></header><div class=entry-content><p>I was looking at backup task running on my desk and saw that it’s spending a lot of time on ~/.local/share/zeitgeist directory. I checked and it had 4.6GB:
du -sh ~/.local/share/zeitgeist/* 118M activity.sqlite 44M activity.sqlite.bck 32K activity.sqlite-shm 4,4G activity.sqlite-wal 311M fts.index WTF? Fortunately I found here that I could easily delete some of this:
zeitgeist-daemon --quit Now check that it’s not running:
ps axu | grep zeitgeist-daemon timor 9105 0.0 0....</p></div><footer class=entry-footer><span title='2016-02-04 00:00:00 +0000 UTC'>2016-02-04</span>&nbsp;·&nbsp;1 min</footer><a class=entry-link aria-label="post link to Zeitgeist activity.sqlite-wal getting huge" href=https://gagor.pl/2016/02/zeitgeist-activity-sqlite-wal-getting-huge/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>XenServer - export VM to file</h2></header><div class=entry-content><p>Sometime you need to make quick and dirty image backup of VM running on XenServer and this post is about such case 😃
List machines:
xl list Name ID Mem VCPUs State Time(s) Domain-0 0 4066 8 r----- 3526567.3 webfront1.example.com 1 4096 4 r----- 3186487.2 webfront2.example.com 2 2048 2 -b---- 920408.2 Now you may export one:
xe vm-export vm=webfront1.example.com filename=/srv/backup/webfront.xva Export succeeded You may also use uuid for that - list machines with xe vm-list (best with less) and then:...</p></div><footer class=entry-footer><span title='2016-01-12 00:00:00 +0000 UTC'>2016-01-12</span>&nbsp;·&nbsp;1 min</footer><a class=entry-link aria-label="post link to XenServer - export VM to file" href=https://gagor.pl/2016/01/xenserver-export-vm-to-file/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Nagios - downtime on host/service from command line with curl</h2></header><div class=entry-content><p>Sometimes deployment process or other havy task may cause some Nagios checks to rise below normal levels and bother admin. If this is expected and you want to add downtime on host/service during this task you may use this script:
#!/bin/bash function die { echo $1; exit 1; } if [[ $# -eq 0 ]] ; then die "Give hostname and time in minutes as parameter!" fi if [[ $# -eq 1 ]] ; then MINUTES=15 else MINUTES=$2 fi HOST=$1 NAGURL=http://nagios....</p></div><footer class=entry-footer><span title='2016-01-11 00:00:00 +0000 UTC'>2016-01-11</span>&nbsp;·&nbsp;2 min</footer><a class=entry-link aria-label="post link to Nagios - downtime on host/service from command line with curl" href=https://gagor.pl/2016/01/nagios-downtime-on-hostservice-from-command-line-with-curl/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Let’s Encrypt - without auto configuration</h2></header><div class=entry-content><p>From the first moment I heard about Let’s Encrypt I liked it and wanted to use it as fast as possible. But the more I read how they want to implement it, the more I dislike it.
Current project with automatic configuration is not what I want to use at all. I have many very complicated configs and I do not trust such tools enough to use them. I like UNIX’s single purpose principle, tools should do one thing and do it well - nothing more....</p></div><footer class=entry-footer><span title='2016-01-04 00:00:00 +0000 UTC'>2016-01-04</span>&nbsp;·&nbsp;1 min</footer><a class=entry-link aria-label="post link to Let’s Encrypt - without auto configuration" href=https://gagor.pl/2016/01/lets-encrypt-without-auto-configuration/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>fail2ban - block wp-login.php brute force attacks</h2></header><div class=entry-content><p>Lately I had a lot of brute force attacks on my WordPress blog. I used basic auth to /wp-admin part in nginx configuration to block this and as a better solution I wan’t to block source IPs at all on firewall.
To do this, place this filter code in /etc/fail2ban/filter.d/wp-login.conf:
# WordPress brute force wp-login.php filter: # # Block IPs trying to authenticate in WordPress blog # # Matches e.g. # 178....</p></div><footer class=entry-footer><span title='2015-12-31 00:00:00 +0000 UTC'>2015-12-31</span>&nbsp;·&nbsp;1 min</footer><a class=entry-link aria-label="post link to fail2ban - block wp-login.php brute force attacks" href=https://gagor.pl/2015/12/fail2ban-block-wp-login-php-brute-force-attacks/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Ansible on Vagrant - skipping: no hosts matched</h2></header><div class=entry-content><p>I have some Ansible roles to configure my vps, Raspberry Pi, etc. I like to test them before I broke something on my real, not clustered machines - I use Vagrant for that.
But with it I had one problem - in playbooks I define hosts as groups of severs ex. web for my vps:
Example Ansible playbook - hosts: web gather_facts: True sudo: True ... But testing machine wasn’t in this group and when I run vagrant I could only see:...</p></div><footer class=entry-footer><span title='2015-12-29 00:00:00 +0000 UTC'>2015-12-29</span>&nbsp;·&nbsp;1 min</footer><a class=entry-link aria-label="post link to Ansible on Vagrant - skipping: no hosts matched" href=https://gagor.pl/2015/12/ansible-on-vagrant-skipping-no-hosts-matched/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Apache - Force caching dynamic PHP content with mod_headers</h2></header><div class=entry-content><p>Normally you want dynamic content to be fresh and not catchable. But sometimes it may be useful to cache it, like when you have website behind reverse proxy. To do this try something like this:
&lt;filesmatch "\.(php|cgi|pl)$"> Header unset Pragma Header unset Expires Header set Cache-Control "max-age=3600, public" &lt;/filesmatch> Sources http://www.askapache.com/htaccess/speed-up-your-site-with-caching-and-cache-control.html</p></div><footer class=entry-footer><span title='2015-12-29 00:00:00 +0000 UTC'>2015-12-29</span>&nbsp;·&nbsp;1 min</footer><a class=entry-link aria-label="post link to Apache - Force caching dynamic PHP content with mod_headers" href=https://gagor.pl/2015/12/apache-force-caching-dynamic-php-content-with-mod_headers/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://gagor.pl/categories/tip/page/2/>«&nbsp;Prev&nbsp;</a>
<a class=next href=https://gagor.pl/categories/tip/page/4/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span><a href=https://gagor.pl>timor's site</a> &copy; 2008-2023</span>
<span>Content licensed under <a rel="license noopener noreferrer" target=_blank href=http://creativecommons.org/licenses/by-sa/4.0/>(CC BY-SA 4.0)</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>