<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Tom's Blog</title>
<meta name=keywords content="Blog,Technical,Automation,DevOps,Cloud,Linux,Leadership"><meta name=description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"><meta name=author content="timor"><link rel=canonical href=https://gagor.pro/><link crossorigin=anonymous href=/assets/css/stylesheet.b75f2a8f35519547db38b55fa84baf47177f24f8e88f96c8d73a55d12ab8bcec.css integrity="sha256-t18qjzVRlUfbOLVfqEuvRxd/JPjoj5bI1zpV0Sq4vOw=" rel="preload stylesheet" as=style><link rel=icon href=https://gagor.pro/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://gagor.pro/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gagor.pro/favicon-32x32.png><link rel=apple-touch-icon href=https://gagor.pro/apple-touch-icon.png><link rel=mask-icon href=https://gagor.pro/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://gagor.pro/index.xml><link rel=alternate type=application/json href=https://gagor.pro/index.json><link rel=alternate type=text/redirects href=https://gagor.pro/_redirects><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-4F5HJ7RNKM"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4F5HJ7RNKM",{anonymize_ip:!1})}</script><meta property="og:title" content="Tom's Blog"><meta property="og:description" content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"><meta property="og:type" content="website"><meta property="og:url" content="https://gagor.pro/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tom's Blog"><meta name=twitter:description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Tom's Blog","url":"https://gagor.pro/","description":"Linux configuration, Automation, Security - Sysadmin/DevOps blog","thumbnailUrl":"https://gagor.pro/favicon.ico","sameAs":["https://www.linkedin.com/in/tgagor","https://github.com/tgagor","https://buymeacoffee.com/tgagor","https://ko-fi.com/tgagor","https://hub.docker.com/u/tgagor","index.xml"]}</script></head><body class="list dark" id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://gagor.pro/ accesskey=h title="Tom's Blog (Alt + H)"><img src=https://gagor.pro/favicon-72x72.png alt aria-label=logo height=36>Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://gagor.pro/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://gagor.pro/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://gagor.pro/bookshelf/ title=Bookshelf><span>Bookshelf</span></a></li><li><a href=https://gagor.pro/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://gagor.pro/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Sniffowanie w FortiOS</h2></header><div class=entry-content><p>Zawsze gdy potrzebujÄ™ zesniffowaÄ‡ coÅ› na Å¼ywo na Fortigateâ€™ach muszÄ™ przeszukaÄ‡ Knowledge Baseâ€‰ external link by przypomnieÄ‡ sobie wszystkie polecenia do tego potrzebne. Tym razem robiÄ™ notatki ğŸ˜ƒ
Sniffowanie diagnose debug enable diagnose debug flow filter addrÂ ip address clearÂ clear filter daddrÂ dest ip address dportÂ destination port negateÂ inverse filter portÂ port protoÂ protocol number saddrÂ source ip address sportÂ source port vdÂ index of virtual domain # np....</p></div><footer class=entry-footer><span title='2012-01-23 00:00:00 +0000 UTC'>2012-01-23</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;timor</footer><a class=entry-link aria-label="post link to Sniffowanie w FortiOS" href=https://gagor.pro/2012/01/sniffowanie-w-fortios/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Upgrade Debian Lenny do Squeeze</h2></header><div class=entry-content><p>Co jakiÅ› czas powtarza siÄ™ sytuacja, gdy muszÄ™ zaktualizowaÄ‡ jakiÅ› serwerek z Lennym do Squeezeâ€™a i za kaÅ¼dym razem muszÄ™ googlaÄ‡ za odpowiednimi ÅºrÃ³dÅ‚ami, ktÃ³re paczki najpierw, etcâ€¦ WiÄ™c sobie zebraÅ‚em wszystko w poniÅ¼szym poÅ›cie.
W razie wÄ…tpliwoÅ›ci patrz tutaj:Â http://www.debian.org/releases/squeeze/releasenotes
ZrÃ³b backup konfiguracji.
Trzeba zaktualizowaÄ‡ ÅºrÃ³dÅ‚a by wskazywaÅ‚y na squeezeâ€™a (poniÅ¼sze polecenie nadpisze Twoje obecne repozytoria):
cat > /etc/apt/sources.list &lt;&lt;SRC deb http://ftp.pl.debian.org/debian/ squeeze main non-free contrib deb-src http://ftp.pl.debian.org/debian/ squeeze main non-free contrib deb http://security....</p></div><footer class=entry-footer><span title='2012-01-13 00:00:00 +0000 UTC'>2012-01-13</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;timor</footer><a class=entry-link aria-label="post link to Upgrade Debian Lenny do Squeeze" href=https://gagor.pro/2012/01/upgrade-debian-lenny-do-squeeze/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy srcset="https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/cover_hu915ff409df8f96319ac86dd37022ae74_15060_360x0_resize_q75_h2_box_2.webp 360w ,https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/cover_hu915ff409df8f96319ac86dd37022ae74_15060_480x0_resize_q75_h2_box_2.webp 480w ,https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/cover_hu915ff409df8f96319ac86dd37022ae74_15060_720x0_resize_q75_h2_box_2.webp 720w ,https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/cover.webp 720w" sizes="(min-width: 768px) 720px, 100vw" src=https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/cover.webp alt width=720 height=300></figure><header class=entry-header><h2 class=entry-hint-parent>Skoda Fabia - Kasownie ostrzeÅ¼eÅ„ OIL i service INSP</h2></header><div class=entry-content><p>JeÅ¼eli jesteÅ› wÅ‚aÅ›cicielem Skody Fabii I to wczeÅ›niej czy pÃ³Åºniej TwÃ³j BAT-Mobil zgÅ‚osi ktÃ³reÅ› z ostrzeÅ¼eÅ„ serwisowych:
OIL - pojawia siÄ™ przewaÅ¼nie co 10 tys. km i wtedy gdy jeszcze nie trzeba wymieniaÄ‡ oleju w silniku ğŸ˜„ service INSP - nie wiem jak czÄ™sto siÄ™ pojawia a oznacza mniej wiÄ™cej â€œczas wesprzeÄ‡ finansowo lokalny autoryzowany serwisâ€. Kasowanie ostrzeÅ¼enia â€œOILâ€ Przy wyÅ‚Ä…czonym silniku wciskamy i przytrzymujemy przycisk kasowaniaÂ przebiegu dziennego/pokrÄ™tÅ‚o ustawiania godziny, od teraz nazywany poÂ prostu â€˜przyciskiemâ€™....</p></div><footer class=entry-footer><span title='2012-01-12 00:00:00 +0000 UTC'>2012-01-12</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;timor</footer><a class=entry-link aria-label="post link to Skoda Fabia - Kasownie ostrzeÅ¼eÅ„ OIL i service INSP" href=https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>MÃ³j domyÅ›lny config dla SciTE</h2></header><div class=entry-content><p>Uruchamiamy SciTE i klikamy menu Options -> Open User Options File, wpisujemy dane:
# domyÅ›lne korzystanie z fontÃ³w o staÅ‚ej szerokoÅ›ci font.base=$(font.monospace) font.small=$(font.monospace) font.comment=$(font.monospace) font.text=$(font.monospace) font.text.comment=$(font.monospace) font.embedded.base=$(font.monospace) font.embedded.comment=$(font.monospace) font.vbs=$(font.monospace) # numerowanie wierszy line.margin.visible=1 line.margin.width=3+ # ikonki toolbara z tematu systemowego toolbar.usestockicons=1 # zaznaczanie blokowe rectangular.selection.modifier=8 # ustawienia wgÅ‚Ä™bieÅ„ kodu indent.size=4 use.tabs=1 indent.automatic=1 WiÄ™cej opcji tutaj:Â http://www.scintilla.org/SciTEDoc.html
Sam pewnie jeszcze nie raz zaktualizujÄ™ ten wpis ğŸ˜„</p></div><footer class=entry-footer><span title='2012-01-11 00:00:00 +0000 UTC'>2012-01-11</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;timor</footer><a class=entry-link aria-label="post link to MÃ³j domyÅ›lny config dla SciTE" href=https://gagor.pro/2012/01/moj-domyslny-config-dla-scite/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Empathy - zamykanie okienka chatu przyciskiem Escape</h2></header><div class=entry-content><p>W Gajimâ€™ie od dawna brakowaÅ‚o mi wygodnego przeszukiwania po liÅ›cie kontaktÃ³w (takiego jakie ma siÄ™ pojawiÄ‡ juÅ¼ niebawem w wersji 0.15 - z pÃ³Å‚tora roku juÅ¼ na to czekamâ€¦). W miÄ™dzy czasie znalazÅ‚em chwilÄ™ by pobawiÄ‡ siÄ™ Empathy - brzydki, nie ma przeglÄ…darki usÅ‚ug XMPP, ale wyszukiwanie na rosterze jest dokÅ‚adnie takie jakiego szukaÅ‚em (w miarÄ™ wpisywania znakÃ³w zawÄ™Å¼a listÄ™ kontaktÃ³w by pasowaÅ‚y do wpisywanego wzorca).
Tyle Å¼e skrÃ³ty klawiaturowe w tym programie zwyczajnie mnie rozwalajÄ… - przez lata przyzwyczaiÅ‚em siÄ™ Å¼e okienka czatu moÅ¼na zamknÄ…Ä‡ Escapeâ€™m - a tutaj nawet nie ma opcji, ktÃ³ra pozwalaÅ‚a by na takÄ… zmianÄ™ zachowania....</p></div><footer class=entry-footer><span title='2011-12-30 00:00:00 +0000 UTC'>2011-12-30</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;timor</footer><a class=entry-link aria-label="post link to Empathy - zamykanie okienka chatu przyciskiem Escape" href=https://gagor.pro/2011/12/empathy-zamykanie-okienka-chatu-przyciskiem-escape/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Automatyczne backupy w stylu snapshot z rsyncâ€™iem</h2></header><div class=entry-content><p>MoÅ¼na znaleÅºÄ‡ wiele tutoriali jakimi narzÄ™dziami wykonywaÄ‡ backupy. W wiÄ™kszoÅ›ci przypadkÃ³w absolutnie wystarczajÄ…cy okaÅ¼e siÄ™ flexbackup. Bardziej wymagajÄ…cy wykorzystajÄ… BackupPC, BaculÄ™ lub AmandÄ™. NarzÄ™dzia te pozwalajÄ… wykonaÄ‡ kopie peÅ‚ne, rÃ³Å¼nicowe, przyrostowe - kompresujÄ…c je dla zaoszczÄ™dzenia miejsca.
Wszystko fajnie - ale problemy pojawiajÄ… siÄ™ przy dostÄ™pie do tych danych. Å»eby odzyskaÄ‡ plik zmodyfikowany dzisiaj trzeba rozpakowaÄ‡ najpierw kopiÄ™ peÅ‚nÄ…, potem rÃ³Å¼nicowÄ…, przyrostowÄ… by wreszcie wyciÄ…gnÄ…Ä‡ plik z wczorajâ€¦ hmm ten teÅ¼ jest skopany....</p></div><footer class=entry-footer><span title='2011-12-29 00:00:00 +0000 UTC'>2011-12-29</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;timor</footer><a class=entry-link aria-label="post link to Automatyczne backupy w stylu snapshot z rsyncâ€™iem" href=https://gagor.pro/2011/12/automatyczne-backupy-w-stylu-snapshot-z-rsynciem/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Konfiguracja modemu USB iPlus na urzÄ…dzeniach FortiGate</h2></header><div class=entry-content><p>ZdarzyÅ‚o mi siÄ™ bawiÄ‡ sprzÄ™towymi Firewallami firmy Fortigate - chcÄ…c sprawdziÄ‡ dziaÅ‚anie pewnych funkcji potrzebowaÅ‚em uruchomiÄ‡ dwa/trzy pudeÅ‚ka na osobnych Å‚Ä…czach. PomysÅ‚ polegaÅ‚ na prÃ³bie zmuszenia pudeÅ‚ek do wspÃ³Å‚pracy z modemem iPlus na USB.
Drugim fajnym zastosowaniem tego triku jest moÅ¼liwoÅ›Ä‡ wykorzystania iPlusa jako â€œzapasowego Å‚Ä…czaâ€ w przypadku awarii gÅ‚Ã³wnego.
DziÄ™ki pomocy inÅ¼yniera Fortigate szybko udaÅ‚o mi siÄ™ zebraÄ‡ potrzebne do dziaÅ‚ania parametry, ktÃ³re naleÅ¼y uruchomiÄ‡ poprzez command line (telnet/ssh)....</p></div><footer class=entry-footer><span title='2011-12-29 00:00:00 +0000 UTC'>2011-12-29</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;timor</footer><a class=entry-link aria-label="post link to Konfiguracja modemu USB iPlus na urzÄ…dzeniach FortiGate" href=https://gagor.pro/2011/12/konfiguracja-modemu-usb-iplus-na-urzadzeniach-fortigate/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>MySQL - Proste metody optymalizacji</h2></header><div class=entry-content><p>WczeÅ›niej czy pÃ³Åºniej zawsze pojawiaÂ siÄ™ potrzeba zoptymalizowania naszej bazy MySQL. PrzedstawiÄ™ kilka zmian w konfiguracji, ktÃ³re powinny zwiÄ™kszyÄ‡ wydajnoÅ›Ä‡ w wiÄ™kszoÅ›ci przypadkÃ³w.
MyISAM -Â key_buffer_size NajprostszÄ… optymalizacjÄ… baz/tabel z mechanizmem MyISAM jest odpowiednie dobranie bufora na cache dla kluczy i indeksÃ³w (dane nigdy nie sÄ… cachowane). PoniÅ¼sze zapytanie pozwala oszacowaÄ‡ zalecany rozmiar cacheâ€™u:
SELECT CONCAT(ROUND(KBS/POWER(1024, IF(PowerOf1024&lt;0,0,IF(PowerOf1024>3,0,PowerOf1024)))+0.4999), SUBSTR(' KMG',IF(PowerOf1024&lt;0,0, IF(PowerOf1024>3,0,PowerOf1024))+1,1)) recommended_key_buffer_size FROM (SELECT LEAST(POWER(2,32),KBS1) KBS FROM (SELECT SUM(index_length) KBS1 FROM information_schema....</p></div><footer class=entry-footer><span title='2011-12-29 00:00:00 +0000 UTC'>2011-12-29</span>&nbsp;Â·&nbsp;5 min&nbsp;Â·&nbsp;timor</footer><a class=entry-link aria-label="post link to MySQL - Proste metody optymalizacji" href=https://gagor.pro/2011/12/mysql-proste-metody-optymalizacji/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>fail2ban - reguÅ‚ki dla dovecotâ€™a</h2></header><div class=entry-content><p>DomyÅ›lna konfiguracja fail2banâ€™a (na Debianie) nie zawiera reguÅ‚ pozwalajÄ…cych na blokowanie prÃ³b wÅ‚amaÅ„ na skrzynki POP/IMAP dla dovecota (no chyba Å¼e korzystamy z saslauthd). MoÅ¼na szybko utworzyÄ‡ wÅ‚asny zestaw filtrÃ³w co przedstawiÄ™ poniÅ¼ej.
Tworzymy plik:Â /etc/fail2ban/filter.d/dovecot.conf
[Definition] failregex = (?: pop3-login|imap-login): .*(?:Authentication failure|Aborted login \(auth failed|Aborted login \(tried to use disabled|Disconnected \(auth failed|Aborted login \(\d+ authentication attempts).*rip=(?P&lt;host>\S*),.* ignoreregex = PÃ³Åºniej dopisujemy na koÅ„cu pliku:Â /etc/fail2ban/jail.conf
[dovecot] enabled = true filter = dovecot port = pop3,pop3s,imap,imaps logpath = /var/log/mail....</p></div><footer class=entry-footer><span title='2011-11-28 00:00:00 +0000 UTC'>2011-11-28</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;timor</footer><a class=entry-link aria-label="post link to fail2ban - reguÅ‚ki dla dovecotâ€™a" href=https://gagor.pro/2011/11/fail2ban-regulki-dla-dovecota/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>X-Forwarded-For + mod_rpaf - logowanie rzeczywistych adresÃ³w IP na Apache za reverse proxy</h2></header><div class=entry-content><p>Gdy juÅ¼ ustawimy reverse proxy przed Apache szybko moÅ¼na zauwaÅ¼yÄ‡ Å¼e w logach zamiast adresÃ³w IP zdalnych uÅ¼ytkownikÃ³w pojawia siÄ™ tylko jeden adres: adres naszego proxy. RÃ³wnieÅ¼ z poziomu phpâ€™a jako adres klienta widaÄ‡ IP naszego proxy.
By poradziÄ‡ sobie z tym problemem trzeba na serwerze reverse proxy ustawiÄ‡ przekazywanie informacji o oryginalnym adresie IP klienta w nagÅ‚Ã³wku X-Forwarded-For. W przypadku gdy reverse proxy dziaÅ‚a na nginxâ€™e wystarczy dodaÄ‡ taki wpis:...</p></div><footer class=entry-footer><span title='2011-11-28 00:00:00 +0000 UTC'>2011-11-28</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;timor</footer><a class=entry-link aria-label="post link to X-Forwarded-For + mod_rpaf - logowanie rzeczywistych adresÃ³w IP na Apache za reverse proxy" href=https://gagor.pro/2011/11/x-forwarded-for-mod_rpaf-logowanie-rzeczywistych-adresow-ip-na-apache-za-reverse-proxy/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://gagor.pro/page/19/>Â«&nbsp;Prev&nbsp;
</a><a class=next href=https://gagor.pro/page/21/>Next&nbsp;&nbsp;Â»</a></nav></footer></main><footer class=footer><span><a href=https://gagor.pro/>Tom's Blog</a> &copy; 2008-2024</span>
<span>Content licensed under <a rel="license noopener noreferrer" target=_blank href=http://creativecommons.org/licenses/by-sa/4.0/>(CC BY-SA 4.0)</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>