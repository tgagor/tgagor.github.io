<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Tom's Blog</title>
<meta name=keywords content="Blog,Technical,Automation,DevOps,Cloud,Linux,Leadership"><meta name=description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"><meta name=author content="timor"><link rel=canonical href=https://gagor.pro/><link crossorigin=anonymous href=/assets/css/stylesheet.b75f2a8f35519547db38b55fa84baf47177f24f8e88f96c8d73a55d12ab8bcec.css integrity="sha256-t18qjzVRlUfbOLVfqEuvRxd/JPjoj5bI1zpV0Sq4vOw=" rel="preload stylesheet" as=style><link rel=icon href=https://gagor.pro/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://gagor.pro/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gagor.pro/favicon-32x32.png><link rel=apple-touch-icon href=https://gagor.pro/apple-touch-icon.png><link rel=mask-icon href=https://gagor.pro/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://gagor.pro/index.xml><link rel=alternate type=application/json href=https://gagor.pro/index.json><link rel=alternate type=text/redirects href=https://gagor.pro/_redirects><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-4F5HJ7RNKM"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4F5HJ7RNKM",{anonymize_ip:!1})}</script><meta property="og:title" content="Tom's Blog"><meta property="og:description" content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"><meta property="og:type" content="website"><meta property="og:url" content="https://gagor.pro/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tom's Blog"><meta name=twitter:description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Tom's Blog","url":"https://gagor.pro/","description":"Linux configuration, Automation, Security - Sysadmin/DevOps blog","thumbnailUrl":"https://gagor.pro/favicon.ico","sameAs":["https://www.linkedin.com/in/tgagor","https://github.com/tgagor","https://buymeacoffee.com/tgagor","https://ko-fi.com/tgagor","https://hub.docker.com/u/tgagor","index.xml"]}</script></head><body class="list dark" id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://gagor.pro/ accesskey=h title="Tom's Blog (Alt + H)"><img src=https://gagor.pro/favicon-72x72.png alt aria-label=logo height=36>Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://gagor.pro/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://gagor.pro/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://gagor.pro/bookshelf/ title=Bookshelf><span>Bookshelf</span></a></li><li><a href=https://gagor.pro/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://gagor.pro/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Sniffowanie w FortiOS</h2></header><div class=entry-content><p>Zawsze gdy potrzebuję zesniffować coś na żywo na Fortigate’ach muszę przeszukać Knowledge Base  external link by przypomnieć sobie wszystkie polecenia do tego potrzebne. Tym razem robię notatki 😃
Sniffowanie diagnose debug enable diagnose debug flow filter addr ip address clear clear filter daddr dest ip address dport destination port negate inverse filter port port proto protocol number saddr source ip address sport source port vd index of virtual domain # np....</p></div><footer class=entry-footer><span title='2012-01-23 00:00:00 +0000 UTC'>2012-01-23</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Sniffowanie w FortiOS" href=https://gagor.pro/2012/01/sniffowanie-w-fortios/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Upgrade Debian Lenny do Squeeze</h2></header><div class=entry-content><p>Co jakiś czas powtarza się sytuacja, gdy muszę zaktualizować jakiś serwerek z Lennym do Squeeze’a i za każdym razem muszę googlać za odpowiednimi źródłami, które paczki najpierw, etc… Więc sobie zebrałem wszystko w poniższym poście.
W razie wątpliwości patrz tutaj: http://www.debian.org/releases/squeeze/releasenotes
Zrób backup konfiguracji.
Trzeba zaktualizować źródła by wskazywały na squeeze’a (poniższe polecenie nadpisze Twoje obecne repozytoria):
cat > /etc/apt/sources.list &lt;&lt;SRC deb http://ftp.pl.debian.org/debian/ squeeze main non-free contrib deb-src http://ftp.pl.debian.org/debian/ squeeze main non-free contrib deb http://security....</p></div><footer class=entry-footer><span title='2012-01-13 00:00:00 +0000 UTC'>2012-01-13</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Upgrade Debian Lenny do Squeeze" href=https://gagor.pro/2012/01/upgrade-debian-lenny-do-squeeze/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy srcset="https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/cover_hu915ff409df8f96319ac86dd37022ae74_15060_360x0_resize_q75_h2_box_2.webp 360w ,https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/cover_hu915ff409df8f96319ac86dd37022ae74_15060_480x0_resize_q75_h2_box_2.webp 480w ,https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/cover_hu915ff409df8f96319ac86dd37022ae74_15060_720x0_resize_q75_h2_box_2.webp 720w ,https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/cover.webp 720w" sizes="(min-width: 768px) 720px, 100vw" src=https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/cover.webp alt width=720 height=300></figure><header class=entry-header><h2 class=entry-hint-parent>Skoda Fabia - Kasownie ostrzeżeń OIL i service INSP</h2></header><div class=entry-content><p>Jeżeli jesteś właścicielem Skody Fabii I to wcześniej czy później Twój BAT-Mobil zgłosi któreś z ostrzeżeń serwisowych:
OIL - pojawia się przeważnie co 10 tys. km i wtedy gdy jeszcze nie trzeba wymieniać oleju w silniku 😄 service INSP - nie wiem jak często się pojawia a oznacza mniej więcej “czas wesprzeć finansowo lokalny autoryzowany serwis”. Kasowanie ostrzeżenia “OIL” Przy wyłączonym silniku wciskamy i przytrzymujemy przycisk kasowania przebiegu dziennego/pokrętło ustawiania godziny, od teraz nazywany po prostu ‘przyciskiem’....</p></div><footer class=entry-footer><span title='2012-01-12 00:00:00 +0000 UTC'>2012-01-12</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Skoda Fabia - Kasownie ostrzeżeń OIL i service INSP" href=https://gagor.pro/2012/01/skoda-fabia-kasownie-ostrzezen-oil-i-service-insp/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Mój domyślny config dla SciTE</h2></header><div class=entry-content><p>Uruchamiamy SciTE i klikamy menu Options -> Open User Options File, wpisujemy dane:
# domyślne korzystanie z fontów o stałej szerokości font.base=$(font.monospace) font.small=$(font.monospace) font.comment=$(font.monospace) font.text=$(font.monospace) font.text.comment=$(font.monospace) font.embedded.base=$(font.monospace) font.embedded.comment=$(font.monospace) font.vbs=$(font.monospace) # numerowanie wierszy line.margin.visible=1 line.margin.width=3+ # ikonki toolbara z tematu systemowego toolbar.usestockicons=1 # zaznaczanie blokowe rectangular.selection.modifier=8 # ustawienia wgłębień kodu indent.size=4 use.tabs=1 indent.automatic=1 Więcej opcji tutaj: http://www.scintilla.org/SciTEDoc.html
Sam pewnie jeszcze nie raz zaktualizuję ten wpis 😄</p></div><footer class=entry-footer><span title='2012-01-11 00:00:00 +0000 UTC'>2012-01-11</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Mój domyślny config dla SciTE" href=https://gagor.pro/2012/01/moj-domyslny-config-dla-scite/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Empathy - zamykanie okienka chatu przyciskiem Escape</h2></header><div class=entry-content><p>W Gajim’ie od dawna brakowało mi wygodnego przeszukiwania po liście kontaktów (takiego jakie ma się pojawić już niebawem w wersji 0.15 - z półtora roku już na to czekam…). W między czasie znalazłem chwilę by pobawić się Empathy - brzydki, nie ma przeglądarki usług XMPP, ale wyszukiwanie na rosterze jest dokładnie takie jakiego szukałem (w miarę wpisywania znaków zawęża listę kontaktów by pasowały do wpisywanego wzorca).
Tyle że skróty klawiaturowe w tym programie zwyczajnie mnie rozwalają - przez lata przyzwyczaiłem się że okienka czatu można zamknąć Escape’m - a tutaj nawet nie ma opcji, która pozwalała by na taką zmianę zachowania....</p></div><footer class=entry-footer><span title='2011-12-30 00:00:00 +0000 UTC'>2011-12-30</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Empathy - zamykanie okienka chatu przyciskiem Escape" href=https://gagor.pro/2011/12/empathy-zamykanie-okienka-chatu-przyciskiem-escape/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Automatyczne backupy w stylu snapshot z rsync’iem</h2></header><div class=entry-content><p>Można znaleźć wiele tutoriali jakimi narzędziami wykonywać backupy. W większości przypadków absolutnie wystarczający okaże się flexbackup. Bardziej wymagający wykorzystają BackupPC, Baculę lub Amandę. Narzędzia te pozwalają wykonać kopie pełne, różnicowe, przyrostowe - kompresując je dla zaoszczędzenia miejsca.
Wszystko fajnie - ale problemy pojawiają się przy dostępie do tych danych. Żeby odzyskać plik zmodyfikowany dzisiaj trzeba rozpakować najpierw kopię pełną, potem różnicową, przyrostową by wreszcie wyciągnąć plik z wczoraj… hmm ten też jest skopany....</p></div><footer class=entry-footer><span title='2011-12-29 00:00:00 +0000 UTC'>2011-12-29</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Automatyczne backupy w stylu snapshot z rsync’iem" href=https://gagor.pro/2011/12/automatyczne-backupy-w-stylu-snapshot-z-rsynciem/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Konfiguracja modemu USB iPlus na urządzeniach FortiGate</h2></header><div class=entry-content><p>Zdarzyło mi się bawić sprzętowymi Firewallami firmy Fortigate - chcąc sprawdzić działanie pewnych funkcji potrzebowałem uruchomić dwa/trzy pudełka na osobnych łączach. Pomysł polegał na próbie zmuszenia pudełek do współpracy z modemem iPlus na USB.
Drugim fajnym zastosowaniem tego triku jest możliwość wykorzystania iPlusa jako “zapasowego łącza” w przypadku awarii głównego.
Dzięki pomocy inżyniera Fortigate szybko udało mi się zebrać potrzebne do działania parametry, które należy uruchomić poprzez command line (telnet/ssh)....</p></div><footer class=entry-footer><span title='2011-12-29 00:00:00 +0000 UTC'>2011-12-29</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Konfiguracja modemu USB iPlus na urządzeniach FortiGate" href=https://gagor.pro/2011/12/konfiguracja-modemu-usb-iplus-na-urzadzeniach-fortigate/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>MySQL - Proste metody optymalizacji</h2></header><div class=entry-content><p>Wcześniej czy później zawsze pojawia się potrzeba zoptymalizowania naszej bazy MySQL. Przedstawię kilka zmian w konfiguracji, które powinny zwiększyć wydajność w większości przypadków.
MyISAM - key_buffer_size Najprostszą optymalizacją baz/tabel z mechanizmem MyISAM jest odpowiednie dobranie bufora na cache dla kluczy i indeksów (dane nigdy nie są cachowane). Poniższe zapytanie pozwala oszacować zalecany rozmiar cache’u:
SELECT CONCAT(ROUND(KBS/POWER(1024, IF(PowerOf1024&lt;0,0,IF(PowerOf1024>3,0,PowerOf1024)))+0.4999), SUBSTR(' KMG',IF(PowerOf1024&lt;0,0, IF(PowerOf1024>3,0,PowerOf1024))+1,1)) recommended_key_buffer_size FROM (SELECT LEAST(POWER(2,32),KBS1) KBS FROM (SELECT SUM(index_length) KBS1 FROM information_schema....</p></div><footer class=entry-footer><span title='2011-12-29 00:00:00 +0000 UTC'>2011-12-29</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to MySQL - Proste metody optymalizacji" href=https://gagor.pro/2011/12/mysql-proste-metody-optymalizacji/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>fail2ban - regułki dla dovecot’a</h2></header><div class=entry-content><p>Domyślna konfiguracja fail2ban’a (na Debianie) nie zawiera reguł pozwalających na blokowanie prób włamań na skrzynki POP/IMAP dla dovecota (no chyba że korzystamy z saslauthd). Można szybko utworzyć własny zestaw filtrów co przedstawię poniżej.
Tworzymy plik: /etc/fail2ban/filter.d/dovecot.conf
[Definition] failregex = (?: pop3-login|imap-login): .*(?:Authentication failure|Aborted login \(auth failed|Aborted login \(tried to use disabled|Disconnected \(auth failed|Aborted login \(\d+ authentication attempts).*rip=(?P&lt;host>\S*),.* ignoreregex = Później dopisujemy na końcu pliku: /etc/fail2ban/jail.conf
[dovecot] enabled = true filter = dovecot port = pop3,pop3s,imap,imaps logpath = /var/log/mail....</p></div><footer class=entry-footer><span title='2011-11-28 00:00:00 +0000 UTC'>2011-11-28</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to fail2ban - regułki dla dovecot’a" href=https://gagor.pro/2011/11/fail2ban-regulki-dla-dovecota/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>X-Forwarded-For + mod_rpaf - logowanie rzeczywistych adresów IP na Apache za reverse proxy</h2></header><div class=entry-content><p>Gdy już ustawimy reverse proxy przed Apache szybko można zauważyć że w logach zamiast adresów IP zdalnych użytkowników pojawia się tylko jeden adres: adres naszego proxy. Również z poziomu php’a jako adres klienta widać IP naszego proxy.
By poradzić sobie z tym problemem trzeba na serwerze reverse proxy ustawić przekazywanie informacji o oryginalnym adresie IP klienta w nagłówku X-Forwarded-For. W przypadku gdy reverse proxy działa na nginx’e wystarczy dodać taki wpis:...</p></div><footer class=entry-footer><span title='2011-11-28 00:00:00 +0000 UTC'>2011-11-28</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to X-Forwarded-For + mod_rpaf - logowanie rzeczywistych adresów IP na Apache za reverse proxy" href=https://gagor.pro/2011/11/x-forwarded-for-mod_rpaf-logowanie-rzeczywistych-adresow-ip-na-apache-za-reverse-proxy/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://gagor.pro/page/19/>«&nbsp;Prev&nbsp;
</a><a class=next href=https://gagor.pro/page/21/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span><a href=https://gagor.pro/>Tom's Blog</a> &copy; 2008-2024</span>
<span>Content licensed under <a rel="license noopener noreferrer" target=_blank href=http://creativecommons.org/licenses/by-sa/4.0/>(CC BY-SA 4.0)</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>