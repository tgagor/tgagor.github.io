<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Posts | timor's site</title>
<meta name=keywords content>
<meta name=description content="Posts - timor's site">
<meta name=author content>
<link rel=canonical href=https://timor.site/posts/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.a6564483631bceb126e1ccf965a2dc167df7b8a408d2785a0deaa63d62e29233.css integrity="sha256-plZEg2MbzrEm4cz5ZaLcFn33uKQI0nhaDeqmPWLikjM=" rel="preload stylesheet" as=style>
<link rel=preload href=https://timor.site/favicon-36x36.png as=image>
<link rel=icon href=https://timor.site/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://timor.site/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://timor.site/favicon-32x32.png>
<link rel=apple-touch-icon href=https://timor.site/apple-touch-icon.png>
<link rel=mask-icon href=https://timor.site/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.0">
<link rel=alternate type=application/rss+xml href=https://timor.site/posts/index.xml>
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-88996819-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="Posts">
<meta property="og:description" content="Linux configuration, Automation, Security - Sysadmin/DevOps blog">
<meta property="og:type" content="website">
<meta property="og:url" content="https://timor.site/posts/">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Posts">
<meta name=twitter:description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://timor.site/posts/"}]}</script>
</head>
<body class=list id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://timor.site/ accesskey=h title="timor's site (Alt + H)">
<img src=https://timor.site/favicon-36x36.png alt=logo aria-label=logo height=36>timor's site</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://timor.site/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
<li>
<a href=https://timor.site/projects/ title=Projects>
<span>Projects</span>
</a>
</li>
<li>
<a href=https://timor.site/archives/ title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://timor.site/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://timor.site/about/ title=About>
<span>About</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<header class=page-header><div class=breadcrumbs><a href=https://timor.site/>Home</a></div>
<h1>Posts</h1>
</header>
<article class=post-entry>
<header class=entry-header>
<h2>Tworzenie patch’y z poleceniami diff i patch
</h2>
</header>
<section class=entry-content>
<p>Jest kilka powodów dla których tworzenie patchy jest przydatne - jeśli tu jesteś to pewnie masz jakiś własny…
Tworzenie patch’a diff -crB old new > from-old-to-new.patch W powyższym poleceniu założyłem że old i new to katalogi z wieloma podkatalogami i plikami - stąd opcja -r. -c dodaje kilka linijek “kontekstu” przez co łatwiej rozeznać się w patch’u. Opcja -B ignoruje puste linie, których patchowanie mnie nie interesuje.
Patchowanie Na początek zawsze warto wywołać polecenie z opcją -dry-run by zobaczyć czy patch wykona się poprawnie:...</p>
</section>
<footer class=entry-footer><span title="2013-04-01 00:00:00 +0000 UTC">2013-04-01</span>&nbsp;·&nbsp;1 min</footer>
<a class=entry-link aria-label="post link to Tworzenie patch’y z poleceniami diff i patch" href=https://timor.site/2013/04/tworzenie-patchy-z-poleceniami-diff-i-patch/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>Rozsynchronizowane serwery NTP
</h2>
</header>
<section class=entry-content>
<p>Miałem ostatnio zabawną sytuację gdy kilka serwerów z zainstalowanym NTPD miało rozjazdy rzędu kilkunastu sekund. Wyszło na to że moje serwery synchronizowały się z różnymi zewnętrznymi serwerami NTP pomiędzy, którymi były rozjazdy i te rozjazdy synchronizowały się na moich serwerach. Jeden “z moich” ustanowiłem głównym a wszystkie inne przekierowałem na niego (komentując wszystkie inne serwery NTP w konfiguracji). Wymusiłem synchronizację:
ntp -q Sprawdziłem jak duży jest offset i jitter (powinny być bardzo małe):...</p>
</section>
<footer class=entry-footer><span title="2013-03-31 00:00:00 +0000 UTC">2013-03-31</span>&nbsp;·&nbsp;1 min</footer>
<a class=entry-link aria-label="post link to Rozsynchronizowane serwery NTP" href=https://timor.site/2013/03/rozsynchronizowane-serwery-ntp/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>Fortigate - VPN IPSec PSK XAuth z Android’a 4.x
</h2>
</header>
<section class=entry-content>
<p>Do niedawna na moim telefonie VPN’ami były: PPTP lub L2TP - oba niespecjalnie mi się podobały. Ale od wersji 4-tej pojawiły się dwa nowe tryby: IPSec Xauth PSK i IPSec Xauth RSA. W pierwszym autoryzacja wykorzystuje login i hasło, w drugim certyfikaty.
Tryb IPSec Xauth PSK jest bardzo wygodny bo łatwo można połączyć go z zewnętrznymi mechanizmami uwierzytelniającymi np. LDAP, Active Directory, itp.
Pokażę jak skonfigurować swojego Fortigate’a by umożliwić połączenie z telefonów i tabletów na Androidzie 4....</p>
</section>
<footer class=entry-footer><span title="2013-03-30 00:00:00 +0000 UTC">2013-03-30</span>&nbsp;·&nbsp;3 min</footer>
<a class=entry-link aria-label="post link to Fortigate - VPN IPSec PSK XAuth z Android’a 4.x" href=https://timor.site/2013/03/fortigate-vpn-ipsec-psk-xauth-z-androida-4-x/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>Nginx - hide server version and name in Server header and error pages
</h2>
</header>
<section class=entry-content>
<p>On Debian you have to install nginx-extras package (because it have built in headers_more module). Then you need two options (best in global configuration /etc/nginx/nginx.conf file, http part):
server_tokens off; more_set_headers 'Server: BadAss'; And it’s good to setup non standard error pages on every site (500 and 404 at minimum):
error_page 403 404 http://mysite.com/areyoulost; error_page 502 503 504 /500.html; </p>
</section>
<footer class=entry-footer><span title="2013-01-24 00:00:00 +0000 UTC">2013-01-24</span>&nbsp;·&nbsp;1 min</footer>
<a class=entry-link aria-label="post link to Nginx - hide server version and name in Server header and error pages" href=https://timor.site/2013/01/nginx-hide-server-version-and-name-in-server-header-and-error-pages/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>PHP - max_input_vars
</h2>
</header>
<section class=entry-content>
<p>W PHP 5.3 pojawiła się nowa zmienna: max_input_vars, która limituje ilość pól możliwych do przesłania przez formularz, obcinając nadmiarowe. Pozwala to zapobiec atakom DoS na tablice hashujące (przynajmniej w tym jednym miejscu). Domyślna wartość tej zmiennej to 1000 i kreatywnym programistom udaje się tą wartość bez problemu osiągnąć 😃
Warte odnotowania jest to że mając suhosin’a trzeba pamiętać o jeszcze dwóch innych zmiennych:
max_input_vars = 3000 suhosin.post.max_vars = 3000 suhosin.request.max_vars = 3000 Zmienne można zmienić od razu w /etc/php5/apache2/php....</p>
</section>
<footer class=entry-footer><span title="2013-01-22 00:00:00 +0000 UTC">2013-01-22</span>&nbsp;·&nbsp;1 min</footer>
<a class=entry-link aria-label="post link to PHP - max_input_vars" href=https://timor.site/2013/01/php-max_input_vars/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>Linux - naprawianie bad sectorów
</h2>
</header>
<section class=entry-content>
<p>Dyski się zużywają i w końcu wcześniej czy później pojawiają się na nich bad sectory. Jeden z moich dysków ciut się posypał a że służy wyłącznie do backupów to mogę z tym żyć. Ale z drugiej strony jeżeli już będę musiał sięgnąć do backupów to chcę mieć pewność że coś odzyskam, dlatego postanowiłem zrobić kilka testów. Nawet jeśli nie naprawi to sektorów to przynajmniej zostaną zaznaczone jako uszkodzone i realokowane....</p>
</section>
<footer class=entry-footer><span title="2012-12-27 00:00:00 +0000 UTC">2012-12-27</span>&nbsp;·&nbsp;2 min</footer>
<a class=entry-link aria-label="post link to Linux - naprawianie bad sectorów" href=https://timor.site/2012/12/linux-naprawianie-bad-sectorow/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>Piwik: śledzenie asynchroniczne + logowanie ksywy komentującego w WordPress’ie
</h2>
</header>
<section class=entry-content>
<p>Korzystam z instancji Piwik’a do monitorowania odwiedzin na stronie i postanowiłem pokombinować czy da się w ten sposób monitorować wejścia konkretnych osób na bazie wpisanego w polu komentarza loginu/ksywki. Jak zacząłem grzebać to przy okazji zmieniłem też sposób ładowania skryptów Piwika na asynchroniczny.
A leci to mniej więcej tak:
&lt;script type="text/javascript"> var i,x,y,ARRcookies=document.cookie.split(";"); var comment_author = ""; for (i=0;i&lt;ARRcookies.length;i++) { x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("=")); y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1); x=x.replace(/^\s+|\s+$/g,""); if (x.indexOf("comment_author") != -1 && x.indexOf("comment_author_email") == -1 && x....</p>
</section>
<footer class=entry-footer><span title="2012-12-21 00:00:00 +0000 UTC">2012-12-21</span>&nbsp;·&nbsp;1 min</footer>
<a class=entry-link aria-label="post link to Piwik: śledzenie asynchroniczne + logowanie ksywy komentującego w WordPress’ie" href=https://timor.site/2012/12/piwik-sledzenie-asynchroniczne-logowanie-ksywy-komentujacego-w-wordpressie/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>Jak dokuczać spamerom
</h2>
</header>
<section class=entry-content>
<p>Dawno, dawno temu… Za górami, za lasami… czytałem sobie tekst Lemat’a o dokuczaniu spamerom i pomyślałem że sam też tak mogę i nawet chcę więc popełniłem skrypcik, który dla losowych słów generował maile. Skrypcik działał z dwa lata na mojej poprzedniej stronie i nie raz zdarzyło się tam jakiejś mendzie zapętlić. Jakoś nie miałem czasu od razu, a później zapomniałem wrzucić go na nową stronie i tak zostało - na pewien czas....</p>
</section>
<footer class=entry-footer><span title="2012-12-18 00:00:00 +0000 UTC">2012-12-18</span>&nbsp;·&nbsp;2 min</footer>
<a class=entry-link aria-label="post link to Jak dokuczać spamerom" href=https://timor.site/2012/12/jak-dokuczac-spamerom/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>Nginx - kompresowanie plików dla gzip_static
</h2>
</header>
<section class=entry-content>
<p>Ruski serwer WWW ma przydatną funkcję serwowania wersji plików skompresowanych gzip’em - przez co możemy plik skompresować raz i będzie on serwowany klientom obsługującym kompresję HTTP ale już bez każdorazowego kompresowania go. Jest to bardzo przydatne na stronach z dużym ruchem gdzie można w ten sposób zaoszczędzić takty CPU na właściwą obsługę połączeń a nie kompresję. Drugie miejsce gdzie może to być przydatne to VPS’y i “cienkie” serwery, które na kompresji przy większym obciążeniu spędzają zbyt dużo czasu i daje się to odczuć w działaniu strony....</p>
</section>
<footer class=entry-footer><span title="2012-12-17 00:00:00 +0000 UTC">2012-12-17</span>&nbsp;·&nbsp;3 min</footer>
<a class=entry-link aria-label="post link to Nginx - kompresowanie plików dla gzip_static" href=https://timor.site/2012/12/nginx-kompresowanie-plikow-dla-gzip_static/></a>
</article>
<article class=post-entry>
<header class=entry-header>
<h2>Apache: mod_authnz_ldap z Active Directory
</h2>
</header>
<section class=entry-content>
<p>Gdy już się dorobi systemu Active Directory wygodnie jest wykorzystać jego bazę użytkowników do autoryzacji w różnych miejscach, np. do pewnych “tajnych i tajniejszych” stron w Apache. Najprościej można to zrobić z wykorzystaniem LDAP.
Warto sprawdzić czy i jak możemy dostać się do kontrolerów. Gdy już mamy wszystkie potrzebne parametry konfigurujemy Apachego - na początek aktywujemy moduły:
a2enmod ldap a2enmod authnz_ldap Teraz możemy edytujemy globalny plik konfiguracyjny mod_ldap’a by ustawić nieco cache’y (bardzo przydatne)....</p>
</section>
<footer class=entry-footer><span title="2012-12-14 00:00:00 +0000 UTC">2012-12-14</span>&nbsp;·&nbsp;2 min</footer>
<a class=entry-link aria-label="post link to Apache: mod_authnz_ldap z Active Directory" href=https://timor.site/2012/12/apache-mod_authnz_ldap-z-active-directory/></a>
</article>
<footer class=page-footer>
<nav class=pagination>
<a class=prev href=https://timor.site/posts/page/10/>« Prev Page</a>
<a class=next href=https://timor.site/posts/page/12/>Next Page »</a>
</nav>
</footer>
</main>
<footer class=footer>
<span><span>© 2011 <a href=https://timor.site>timor&rsquo;s site</a></span> <span>Licensed under <a rel=license rel="noopener noreferrer" target=_blank href=http://creativecommons.org/licenses/by-sa/4.0/>(CC BY-SA 4.0)</a></span></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>