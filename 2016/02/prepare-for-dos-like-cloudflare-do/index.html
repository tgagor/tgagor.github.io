<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I watched nice presentation about how Cloudflare protects itself against DoS. Most of us are not able to do that exactly like them but some of tips were general enough to be used on typical web front server.
I took notes from this presentation and presented here. Thanks to Marek agreement I also reposted all examples (in easier to copy paste way).
Howto prepare against ACK/FIN/RST/X-mas flood Use conntrack rule:"><meta name=theme-color content="#c64858"><meta property="og:title" content="Prepare for DoS like Cloudflare do • TiMoR"><meta property="og:description" content="I watched nice presentation about how Cloudflare protects itself against DoS. Most of us are not able to do that exactly like them but some of tips were general enough to be used on typical web front server.
I took notes from this presentation and presented here. Thanks to Marek agreement I also reposted all examples (in easier to copy paste way).
Howto prepare against ACK/FIN/RST/X-mas flood Use conntrack rule:"><meta property="og:url" content="https://timor.site/2016/02/prepare-for-dos-like-cloudflare-do/"><meta property="og:site_name" content="timor's site"><meta property="og:type" content="article"><meta property="og:image" content="https://www.gravatar.com/avatar/cfa9a17577371083824a78c303cc8ed7?s=256"><meta property="article:section" content="posts"><meta property="article:tag" content="DDoS"><meta property="article:tag" content="DoS"><meta property="article:tag" content="iptables"><meta property="article:tag" content="Security"><meta property="article:published_time" content="2016-02-05T00:00:00Z"><meta property="article:modified_time" content="2016-02-05T00:00:00Z"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.76.5"><title>Prepare for DoS like Cloudflare do • TiMoR</title><link rel=canonical href=https://timor.site/2016/02/prepare-for-dos-like-cloudflare-do/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#c64858}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-88996819-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="page type-posts layout-post has-sidebar"><div class=site><div id=sidebar class=sidebar><a class=screen-reader-text href=#main-menu>Skip to Main Menu</a><div class=container><section class="widget widget-about sep-after"><header><div class=logo><a href=/><img src=/favicon.ico></a></div><h2 class="title site-title"><a href=/>timor's site</a></h2><div class=desc>Linux configuration, Automation, Security - Sysadmin/DevOps blog</div></header></section><section class="widget widget-search sep-after"><header><h4 class="title widget-title">Search</h4></header><form action=/search id=search-form class=search-form><label><span class=screen-reader-text>Search</span>
<input id=search-term class=search-term type=search name=q placeholder=Search&mldr;></label></form></section><section class="widget widget-sidebar_menu sep-after"><nav id=sidebar-menu class="menu sidebar-menu" aria-label="Sidebar Menu"><div class=container><ul><li class=item><a href=/></a></li><li class=item><a href=/>Home</a></li><li class="item has-children"><a href=/categories/howto/>HOWTO</a><button class=sub-menu-toggler>
<span class=screen-reader-text>expand sub menu</span>
<span class=sign></span></button><ul class=sub-menu><li class=item><a href=/categories/tip/>Tips</a></li></ul></li><li class=item><a href=/categories/off-topic/>Off-topic</a></li><li class=item><a href=/categories/gotowanie/>Gotowanie</a></li><li class=item><a href=/about/>About</a></li></ul></div></nav></section></div><div class=sidebar-overlay></div></div><div class=main><a class=screen-reader-text href=#content>Skip to Content</a>
<button id=sidebar-toggler class=sidebar-toggler aria-controls=sidebar>
<span class=screen-reader-text>Toggle Sidebar</span>
<span class=open><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></span><span class=close><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></span></button><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/posts/>Posts</a></li><li><span>Prepare for DoS like Cloudflare do</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">timor's site</p><p class="desc site-desc">Linux configuration, Automation, Security - Sysadmin/DevOps blog</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Prepare for DoS like Cloudflare do</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2016-02-05T00:00:00Z>2016-02-05</time></span>
<span class=byline><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M21 21V20c0-2.76-4-5-9-5s-9 2.24-9 5v1"/><path d="M16 6.37A4 4 0 1112.63 3 4 4 0 0116 6.37z"/></svg><span class=screen-reader-text>by </span><a href=/authors/timor>TiMoR</a></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>4 mins read</span></div></div></header><div class="container entry-content"><p>I watched nice presentation about how Cloudflare protects itself against DoS. Most of us are not able to do that exactly like them but some of tips were general enough to be used on typical web front server.</p><p>I took notes from this presentation and presented here. Thanks to Marek agreement I also reposted all examples (in easier to copy paste way).</p><h2 id=howto-prepare-against-ackfinrstx-mas-flood>Howto prepare against ACK/FIN/RST/X-mas flood</h2><p>Use <code>conntrack</code> rule:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -A INPUT --dst 1.2.3.4 -m conntrack --ctstate INVALID -j DROP
</code></pre></div><p>which will only work with disabled <code>tcp_loose</code> setting (it&rsquo;s by default enabled) with addition to <code>sysctl</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sysctl -w net.netfilter.nf_conntrack_tcp_loose<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</code></pre></div><h2 id=howto-prepare-against-syn-floods>Howto prepare against SYN floods</h2><p>SYN flood is hard case - because when you use conntrack it will make your performance worst validating state for every new single packet.</p><p>The only way to get around this is to enable syncookies:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sysctl -w net.ipv4.tcp_syncookies<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
sysctl -w net.ipv4.tcp_timestamps<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</code></pre></div><p>Enabling syncookies will cause loose of some of connection informations, that are pretty useful like:</p><ul><li>window scaling factor</li><li>ECN bit (Explicit Congestion Notification)</li></ul><p>For that we will use <code>tcp_timestamp</code> option, that will use few bits from timestamp field to store some of this informations.</p><p>This still may be not efficient enough, but in kernel 4.4 there will be some update to how syncookies are served that should make it few times faster than with older one.</p><p>Related docs: <a href=https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt>https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt</a></p><h2 id=howto-prepare-against-botnet-attack>Howto prepare against botnet attack</h2><p>Symptoms:</p><ul><li>concurrent connection count going up</li><li>many sockets in <code>orphaned</code> state</li><li>many sockets in <code>time wait</code> state</li></ul><p>Solutions:</p><ol><li>Enable <code>connlimit</code> feature on <code>conntrack</code> to limit amount of concurrent connections to our service</li><li>Use hashlimits to rate limit SYN packets per IP</li><li>Use <code>ipsets</code> to efficiently block many IP/subnet addresses<ul><li>manual blacklisting - feed IP blacklist from HTTP server logs</li><li>supports subnets, timeouts</li><li>automatic blacklisting hashlimits</li></ul></li><li>Disable HTTP keep-alives to make this attack look more like SYN flood</li></ol><p>This may still not work against DDoS because huge amount of bots won&rsquo;t allow you to block them efficiently enough.</p><h2 id=some-exciting-system-tweaks-and-examples-from-this-presentation>Some exciting system tweaks and examples from this presentation</h2><p>I hope to find some time to merge them into template/script that could be used much easier - but first I have to play with these rules a little and test what will be most useful.</p><h3 id=nic-discard-with-flow-steering>NIC: Discard with flow steering</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ethtool -N eth3 flow-type udp4 dst-ip 129.168.254.30 dst-port <span style=color:#ae81ff>53</span> action -1
</code></pre></div><h3 id=flow-steering-for-priority>Flow steering for priority</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ethtool -X eth3 weight <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>1</span>
ethtool -N eth3 flow-type tcp4 dst-port <span style=color:#ae81ff>22</span> action <span style=color:#ae81ff>0</span>
</code></pre></div><h3 id=syn-backlog-size>SYN backlog size</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sysctl -w net.core.somaxconn<span style=color:#f92672>=</span><span style=color:#ae81ff>65535</span>
sysctl -w net.ipv4.tcp_max_syn_backlog<span style=color:#f92672>=</span><span style=color:#ae81ff>65535</span>
</code></pre></div><p>It&rsquo;s rounded to next power of two (in this case to 65536).</p><h3 id=syn-backlog-decay>SYN backlog decay</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sysctl -w net.ipv4.tcp_synack_retries<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</code></pre></div><h3 id=l7-connection-count>L7 connection count</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sysctl -w net.ipv4.tcp_max_orphans<span style=color:#f92672>=</span><span style=color:#ae81ff>262144</span>
sysctl -w net.ipv4.tcp_orphan_retries<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>

sysctl -w net.ipv4.tcp_max_tw_buckets<span style=color:#f92672>=</span><span style=color:#ae81ff>360000</span>
sysctl -w net.ipv4.tcp_tw_reuse<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
sysctl -w net.ipv4.tcp_fin_timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
</code></pre></div><h3 id=l3-u32>L3: u32</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -A INPUT <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --dst 1.2.3.4 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --p udp -m udp --dport <span style=color:#ae81ff>53</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -m u32 --u32 <span style=color:#e6db74>&#34;6&amp;0xFF=0x6 &amp;&amp; 4&amp;0x1FFF=0 &amp;&amp; 0&gt;&gt;22&amp;0x3C@4=0x29&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j DROP
</code></pre></div><h3 id=l4-conntrack>L4: Conntrack</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -t raw -A PREROUTING <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -i eth2 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --dst 1.2.3.4 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j ACCEPT

iptables -t raw -A PREROUTING <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -i eth2 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j NOTRACK

iptables -A INPUT <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --dst 1.2.3.4 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -m conntrack --ctstate INVALID <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j DROP
</code></pre></div><h2 id=tuning-conntrack>Tuning conntrack</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sysctl -w net.netfilter.nf_conntrack_tcp_loose<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
sysctl -w net.netfilter.nf_conntrack_helper<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
sysctl -w net.nf_conntrack_max<span style=color:#f92672>=</span><span style=color:#ae81ff>2000000</span>
echo <span style=color:#ae81ff>2500000</span> &gt; /sys/module/nf_conntrack/parameters/hashsize
</code></pre></div><p>More info about conntrack sysctl options: <a href=https://www.kernel.org/doc/Documentation/networking/nf_conntrack-sysctl.txt>https://www.kernel.org/doc/Documentation/networking/nf_conntrack-sysctl.txt</a></p><h3 id=l7-connlimit>L7: Connlimit</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -t raw -A PREROUTING <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -i eth2 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --dst 1.2.4.5 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j ACCEPT

iptables -A INPUT <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --dst 1.2.3.4 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -p tcp -m tcp --dport <span style=color:#ae81ff>80</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK SYN <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -m connlimit <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --connlimit-above <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --connlimit-mask <span style=color:#ae81ff>32</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --connlimit-saddr <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j DROP
</code></pre></div><h3 id=l7-ipset-for-blacklisting>L7: ipset for blacklisting</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ipset -exist create ta_d335c5 hash:net family inet

ipset add ta_d335c5 192.168.0.0/16
ipset add ta_d335c5 10.0.0/8

iptables -A INPUT <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -m set --match-set ta_d335c5 src <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j DROP
</code></pre></div><h3 id=l7-being-evil---tarpit>L7: being evil - TARPIT</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -A INPUT <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -m set --match-set ta_d335c5 src <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j TARPIT
</code></pre></div><p>TARPIT target will imitate successful connection for the client (bot in this case) but without responding to it&rsquo;s queries. It will cost that bot a lot more resources and time to timeout and drop this connection than when using DROP or REJECT here.</p><h3 id=l7-hashlimit-for-rate-limiting>L7: hashlimit for rate limiting</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -A  INPUT <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --dst 1.2.3.4 -p tcp -m tcp --dport <span style=color:#ae81ff>80</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --tcp-flags FIN,SYN,RST,PSH,ACK,URG SYN <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -m hashlimit <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --hashlimi-above 123/sec <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --hashlimit-burst <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --hashlimit-mode srcip <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --hashlimit-srcmask <span style=color:#ae81ff>24</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --hashlimit-name 341654b1d4af9bf <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j DROP
</code></pre></div><h3 id=l7-auto-blacklist>L7: auto-blacklist</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ipset -exist create blacklist hash:net timeout <span style=color:#ae81ff>60</span>

iptables -A INPUT <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --dst 1.2.3.4 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -m set --match-set blaclist src <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j DROP

iptables -A INPUT <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --dst 1.2.3.4 -p tcp -m tcp --dport <span style=color:#ae81ff>80</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --tcp-flags FIN,SYN,RST,PSH,ACK,URG SYN <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -m hashlimit <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --hashlimit-above 100/sec <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --hashlimit-mode srcip <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --hashlimit-srcmask <span style=color:#ae81ff>24</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --hashlimit-name hl_blacklist <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j SET --add-set blacklist src
</code></pre></div><h3 id=l7-payload-in-tcp---string>L7+: payload in TCP - string</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -A INPUT <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --dst 1.2.3.4 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -p tcp --dport <span style=color:#ae81ff>80</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -m string <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --hex-string 486f737777777777... <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --from <span style=color:#ae81ff>231</span> --to <span style=color:#ae81ff>300</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -j DROP
</code></pre></div><p>For more informations and explanations watch this great presentation:</p><p>And here is the whole presentation with additional examples:<br><a href=https://speakerdeck.com/majek04/lessons-from-defending-the-indefensible>https://speakerdeck.com/majek04/lessons-from-defending-the-indefensible</a></p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/howto/>HOWTO</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/ddos/>DDoS</a>, <a class=tag href=/tags/dos/>DoS</a>, <a class=tag href=/tags/iptables/>iptables</a>, <a class=tag href=/tags/security/>Security</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before"><a href=/2016/02/zeitgeist-activity-sqlite-wal-getting-huge/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Zeitgeist activity.sqlite-wal getting huge</a></div><div class="next-entry sep-before"><a href=/2016/02/intel-dual-band-wireless-ac-7260-for-desktop-on-linux/><span class=screen-reader-text>Next post: </span>Intel Dual Band Wireless-AC 7260 for Desktop on Linux<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/tgagor target=_blank rel="noopener me"><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://linkedin.com/in/tgagor target=_blank rel="noopener me"><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li><li><a href=https://timor.site/index.xml target=_blank rel="noopener me"><span class=screen-reader-text>Open Rss account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2011-2021 TiMoR</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script></body></html>