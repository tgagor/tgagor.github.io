<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Linux | timor's site</title>
<meta name=keywords content>
<meta name=description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog">
<meta name=author content>
<link rel=canonical href=https://timor.site/tags/linux/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.a6564483631bceb126e1ccf965a2dc167df7b8a408d2785a0deaa63d62e29233.css integrity="sha256-plZEg2MbzrEm4cz5ZaLcFn33uKQI0nhaDeqmPWLikjM=" rel="preload stylesheet" as=style>
<link rel=preload href=https://timor.site/favicon-72x72.png as=image>
<link rel=icon href=https://timor.site/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://timor.site/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://timor.site/favicon-32x32.png>
<link rel=apple-touch-icon href=https://timor.site/apple-touch-icon.png>
<link rel=mask-icon href=https://timor.site/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.0">
<link rel=alternate type=application/rss+xml href=https://timor.site/tags/linux/index.xml>
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-88996819-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="Linux">
<meta property="og:description" content="Linux configuration, Automation, Security - Sysadmin/DevOps blog">
<meta property="og:type" content="website">
<meta property="og:url" content="https://timor.site/tags/linux/">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Linux">
<meta name=twitter:description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog">
</head>
<body class=list id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://timor.site/ accesskey=h title="timor's site (Alt + H)">
<img src=https://timor.site/favicon-72x72.png alt=logo aria-label=logo height=36>timor's site</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://timor.site/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
<li>
<a href=https://timor.site/projects/ title=Projects>
<span>Projects</span>
</a>
</li>
<li>
<a href=https://timor.site/archives/ title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://timor.site/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://timor.site/about/ title=About>
<span>About</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<header class=page-header><div class=breadcrumbs><a href=https://timor.site/>Home</a>&nbsp;»&nbsp;<a href=https://timor.site/tags/>Tags</a></div>
<h1>Linux</h1>
</header>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>fsck.ext4 - Błąd podczas przydzielania struktury icount: Memory allocation failed
</h2>
</header>
<section class=entry-content>
<p>Miałem ostatnio dziwną przygodę: pewien serwer do backupu gdzie ląduje dużo małych plików i dodatkowo tworzonych jest sporo hardlinków zaliczył pada. Co prawda starałem się go grzecznie położyć z pomocą Magic SysRq ale ponieważ nie wiedziałem co było przyczyną awarii fsck wydawał się wskazany.
Podczas próby uruchomienia fsck.ext4 na systemie plików o rozmiarze ok 14TB z kilkuset milionami plików po kilkudziesięciu sekundach otrzymywałem komunikat:
Błąd podczas przydzielania struktury icount: Memory allocation failed...</p>
</section>
<footer class=entry-footer><span title="2011-09-21 00:00:00 +0000 UTC">2011-09-21</span>&nbsp;·&nbsp;2 min</footer>
<a class=entry-link aria-label="post link to fsck.ext4 - Błąd podczas przydzielania struktury icount: Memory allocation failed" href=https://timor.site/2011/09/fsck-ext4-blad-podczas-przydzielania-struktury-icount-memory-allocation-failed/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>Magic SysRq - bezpieczny reset Linux’a
</h2>
</header>
<section class=entry-content>
<p>Pomimo iż Linux uchodzi za stabilne środowisko to raz na jakiś czas trafi się ciężka zwiecha - z powodu przeciążenia, awarii sprzętu… nieistotne…
Załóżmy że licho wzięło za cel główny serwer plików lub bazę danych dla wielu, wielu stron internetowych. Dostać się po ssh nie możemy bo lecą timeout’y, a siedząc bezpośrednio przy klawiaturze konsola nie reaguje. Mimo to coś ostro daje po dyskach, więc ewentualny twardy reset to na bank utrata części plików… jeśli system po nim w ogóle wstanie… 😑...</p>
</section>
<footer class=entry-footer><span title="2011-09-17 00:00:00 +0000 UTC">2011-09-17</span>&nbsp;·&nbsp;2 min</footer>
<a class=entry-link aria-label="post link to Magic SysRq - bezpieczny reset Linux’a" href=https://timor.site/2011/09/magic-sysrq-bezpieczny-reset-linuxa/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>approx - cachujące proxy dla repozytoriów Debiana
</h2>
</header>
<section class=entry-content>
<p>Wielu administratorów gdy zaczyna swoją przygodę zarządza jedną/dwoma maszynami… Po pewnym czasie jest ich już kilka… W którymś momencie dostrzega się zalety wirtualizacji i na kilku maszynach fizycznych działa kilkanaście czy kilkadziesiąt maszyn wirtualnych. W takiej sytuacji pobieranie aktualizacji dla wszystkich maszyn potrafi mocno zabić łącze.
I w tym momencie zaczynamy się zastanawiać czy może nie warto byłoby zrobić własnego mirror’a paczek dla naszego ulubionego distro… do prywatnego użytku… synchronizowanego w nocy by nikomu nie przeszkadzać… i dostępnego nawet gdy będziemy offline… Zaczynamy liczyć miejsce i okazuje się że repozytorium Debiana dla architektury i386 to prawie 60GB (sic!...</p>
</section>
<footer class=entry-footer><span title="2011-09-16 00:00:00 +0000 UTC">2011-09-16</span>&nbsp;·&nbsp;3 min</footer>
<a class=entry-link aria-label="post link to approx - cachujące proxy dla repozytoriów Debiana" href=https://timor.site/2011/09/approx-cachujace-proxy-dla-repozytoriow-debiana/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>Wymuszenie zwolnienia pamięci buforów dyskowych na Linux’ie
</h2>
</header>
<section class=entry-content>
<p>Linux bardzo agresywnie wykorzystuje wolną pamięć RAM do buforowania danych odczytywanych z dysków (inode’ów, plików, itd…). Ma to niebagatelny wpływ na zwiększenie szybkości uruchamiania programów które już raz zostały uruchomione. Jednak nie zawsze jest to pożądane zachowanie, np. testując szybkość uruchomienia/wykonywania tworzonej przez nas aplikacji - buforowanie zmienia czas ładowania aplikacji przy kolejnych uruchomieniach. Dobrze byłoby móc wymusić zwolnienie buforów by każdy start programu miał porównywalne “warunki startowe”.
Na szczęście można to zrobić w prosty sposób:...</p>
</section>
<footer class=entry-footer><span title="2011-09-15 00:00:00 +0000 UTC">2011-09-15</span>&nbsp;·&nbsp;1 min</footer>
<a class=entry-link aria-label="post link to Wymuszenie zwolnienia pamięci buforów dyskowych na Linux’ie" href=https://timor.site/2011/09/wymuszenie-zwolnienia-pamieci-buforow-dyskowych-na-linuxie/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>Zabezpieczenie Apachego na Debianie przed slowloris’em
</h2>
</header>
<section class=entry-content>
<p>Od jakiegoś czasu dostępny jest w sieci skrypt slowloris.pl pozwalający z pojedynczego komputera wykonać atak DOS na zdalny serwer WWW. Atak polega na uruchomieniu wielu równoczesnych sesji i bardzo wolnym wysyłaniu komunikatów HTTP. Atakujący udaje “klienta z wolnym łączem” równocześnie uruchamiając kolejne sesje by po pewnym czasie zająć wszystkie dostępne. Serwer WWW przestaje wtedy odpowiadać na zapytania od innych klientów. Dodatkowo na źle wyskalowanych serwerach duża liczba procesów Apachego może spowodować swapowanie i błędy braku pamięci....</p>
</section>
<footer class=entry-footer><span title="2011-09-12 00:00:00 +0000 UTC">2011-09-12</span>&nbsp;·&nbsp;3 min</footer>
<a class=entry-link aria-label="post link to Zabezpieczenie Apachego na Debianie przed slowloris’em" href=https://timor.site/2011/09/zabezpieczenie-apachego-na-debianie-przed-slowlorisem/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>Sprawdzenie który proces obciąża dyski
</h2>
</header>
<section class=entry-content>
<p>Na jednym z serwerów zauważyłem dziwny wzrost obciążenia. Tzw. LOAD od kilku dni po woli rósł. top pokazywał że dwa rdzenie CPU czekają na dane z dysku - tzw. io wait na poziomie 80~90% ale żaden proces w znaczącym stopniu nie obciążał CPU.
Jest kilka narzędzi (iostat, wmstat), które pozwalają monitorować obciążenie dysków ale ja nie szukałem informacji czy i w jakim stopniu dyski są obciążone - wiedziałem że są. Chciałem dowiedzieć się który proces generuje to obciążenie - by móc go ubić 😃...</p>
</section>
<footer class=entry-footer><span title="2011-09-02 00:00:00 +0000 UTC">2011-09-02</span>&nbsp;·&nbsp;1 min</footer>
<a class=entry-link aria-label="post link to Sprawdzenie który proces obciąża dyski" href=https://timor.site/2011/09/sprawdzenie-ktory-proces-obciaza-dyski/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>Konfiguracja backportów na Debianie
</h2>
</header>
<section class=entry-content>
<p>Tak się składa, że Debian ze względu na stosunkowo rzadkie wydawanie kolejnych wersji szybko staje się niezbyt świeży a dostępne w nim pakiety często nie spełaniają naszych oczekiwań. Nie ma najnowszej wersji Subversion… Nie ma mod_security itd, itp…
Rozwiązaniem tego problemu może być instalacja pakietów z testowej gałęzi ale można polec na zależnościach. Można też kompilować ze źródeł… Tak czy siak w obu przypadkach aktualizacja i utrzymanie tak zmodyfikowanego systemu byłoby jak wrzód na zadku....</p>
</section>
<footer class=entry-footer><span title="2011-08-29 00:00:00 +0000 UTC">2011-08-29</span>&nbsp;·&nbsp;2 min</footer>
<a class=entry-link aria-label="post link to Konfiguracja backportów na Debianie" href=https://timor.site/2011/08/konfiguracja-backportow-na-debianie/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>Optymalizacja PHP z eAccelerator’em
</h2>
</header>
<section class=entry-content>
<p>Przy okazji wykonywania kilku drobnych optymalizacji swojej stronki natknąłem się na eAccelerator’a. Ciekawy projekt, który w sposobie działania przypomina Zend Optimizer’a ale ma jedną zasadniczą zaletę - jest darmowy 😃
Niestety nie ma go w repozytoriach Debiana, więc trzeba go sobie skompilować - cały proces jest dość prosty. Zaczynamy od pobrania najświeższej paczki, obecnie jest to wersja 0.9.5.3:
Pobierz eAccelerator (ostatnio miałem problem z tym linkiem więc proponuję pogooglać)
Pobieramy i rozpakowujemy pliki:...</p>
</section>
<footer class=entry-footer><span title="2011-08-29 00:00:00 +0000 UTC">2011-08-29</span>&nbsp;·&nbsp;3 min</footer>
<a class=entry-link aria-label="post link to Optymalizacja PHP z eAccelerator’em" href=https://timor.site/2011/08/optymalizacja-php-z-eacceleratorem/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>Statystyki odwiedzin dla wielu serwisów z AWStats
</h2>
</header>
<section class=entry-content>
<p>Co prawda na swojej stronie zrobiłem kilka podstawowych statystyk i coś tam sobie loguję do bazy danych, ale gdyby się chwilę zastanowić to przecież to samo robi serwer www - wrzuca do logów każde zapytanie HTTP, kod błędu, nazwę agenta, itd. Dublowanie tych danych nie jest najbardziej optymalne.
Stąd też chwilę pogooglałem i znalazłem świetny Open Source’owy projekt: AWStats, który jest webowym analizatorem logów dla serwerów HTTP, FTP i SMTP....</p>
</section>
<footer class=entry-footer><span title="2011-08-29 00:00:00 +0000 UTC">2011-08-29</span>&nbsp;·&nbsp;5 min</footer>
<a class=entry-link aria-label="post link to Statystyki odwiedzin dla wielu serwisów z AWStats" href=https://timor.site/2011/08/statystyki-odwiedzin-dla-wielu-serwisow-z-awstats/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>Dynamiczne IP i RBL’e
</h2>
</header>
<section class=entry-content>
<p>Mój serwer pocztowy działa od jakiegoś czasu na dynamicznym IP (dobre bo tanie…) i przeważnie nie ma z tym problemów. Postarałem się jak mogłem ustawiając SPF’a i DomainKeys aby uwiarygodnić go u większych dostawców poczty.
Niestety wszystko to diabli biorą w momencie gdy wygasa mi leasse DHCP i dostaję nowe IP po jakimś spamerze/zombiaku. Wisi takie w 2-3 większych RBL’ach i o dostarczaniu poczty można zapomnieć. Miło gdy jeszcze zdalny MTA zechce odesłać zwrotkę “zróbta coś bo wisisz w RBL’u takim a takim…”, ale zdecydowania niefajnie gdy wysyłasz pocztę a ona od razu leci do /dev/null rblcheck Poszperałem trochę i znalazłem fajne narzędzie aka rblcheck, które sprawdza domyślnie kilka RBL’i....</p>
</section>
<footer class=entry-footer><span title="2011-08-27 00:00:00 +0000 UTC">2011-08-27</span>&nbsp;·&nbsp;2 min</footer>
<a class=entry-link aria-label="post link to Dynamiczne IP i RBL’e" href=https://timor.site/2011/08/dynamiczne-ip-i-rble/></a>
</article>
<footer class=page-footer>
<nav class=pagination>
<a class=prev href=https://timor.site/tags/linux/page/8/>« Prev Page</a>
<a class=next href=https://timor.site/tags/linux/page/10/>Next Page »</a>
</nav>
</footer>
</main>
<footer class=footer>
<span><a href=https://timor.site/>timor's site</a> &copy; 2008-2021</span>
<span>Content licensed under <a rel="license noopener noreferrer" target=_blank href=http://creativecommons.org/licenses/by-sa/4.0/>(CC BY-SA 4.0)</a></span>
</footer>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>