<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Linux | Tom's Blog</title>
<meta name=keywords content><meta name=description content="pages for taxonomy (classification) term: linux"><meta name=author content="timor"><link rel=canonical href=https://gagor.pro/tags/linux/><link crossorigin=anonymous href=/assets/css/stylesheet.b75f2a8f35519547db38b55fa84baf47177f24f8e88f96c8d73a55d12ab8bcec.css integrity="sha256-t18qjzVRlUfbOLVfqEuvRxd/JPjoj5bI1zpV0Sq4vOw=" rel="preload stylesheet" as=style><link rel=icon href=https://gagor.pro/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://gagor.pro/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gagor.pro/favicon-32x32.png><link rel=apple-touch-icon href=https://gagor.pro/apple-touch-icon.png><link rel=mask-icon href=https://gagor.pro/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://gagor.pro/tags/linux/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Linux"><meta property="og:description" content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"><meta property="og:type" content="website"><meta property="og:url" content="https://gagor.pro/tags/linux/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Linux"><meta name=twitter:description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"></head><body class="list dark" id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://gagor.pro/ accesskey=h title="Tom's Blog (Alt + H)"><img src=https://gagor.pro/favicon-36x36.png alt aria-label=logo height=36>Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://gagor.pro/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://gagor.pro/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://gagor.pro/bookshelf/ title=Bookshelf><span>Bookshelf</span></a></li><li><a href=https://gagor.pro/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://gagor.pro/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://gagor.pro/>Home</a>&nbsp;»&nbsp;<a href=https://gagor.pro/tags/>Tags</a></div><h1>Linux</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Listowanie zasobów NFS</h2></header><div class=entry-content><p>Szkoda że polecenia do obsługi NFS’a nie zaczynają się od nfs* - łatwiej byłoby mi je zapamiętać. A jednym z takich, zapominanych najczęściej jest listowanie zasobów, szczególnie przydatne gdy korzysta się z NFS’a na jakimś NAS’ie (którego magiczny soft nie pokazuje gdzie i co eksportuje):
showmount -e 192.168.1.10 Export list for 192.168.1.10: /mnt/pools/A/A0/Music * /mnt/pools/A/A0/Movies * /mnt/pools/A/A0/Backups * /mnt/pools/A/A0/Pictures * /mnt/pools/A/A0/Documents * Teraz możemy zamontować zasób:
mount 192.168.1.10:/mnt/pools/A/A0/Music /mnt/music</p></div><footer class=entry-footer><span title='2012-09-10 00:00:00 +0000 UTC'>2012-09-10</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Listowanie zasobów NFS" href=https://gagor.pro/2012/09/listowanie-zasobow-nfs/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Apache: ograniczenie dostępu dla zalogowanych użytkowników z mod_rewrite i mod_auth_basic</h2></header><div class=entry-content><p>Niedawno trafiłem na ciekawy problem w mod_rewrite - by przekierowywać użytkowników logujących się jednym z modułów mod_auth_basic do dedykowanych im katalogów, równocześnie blokując dostęp do katalogów innych użytkowników. Nie brzmi to jakoś strasznie ale problem okazał się być całkiem nietrywialnym. Teoretyczne rozwiązanie sprowadzało się do wyszukania loginu użytkownika ze ścieżki URI i porównania z nazwą użytkownika ze zmiennej %{REMOTE_USER} - jeśli wartości się różnią to Forbidden. Ale szybko okazało się że w RewriteCond zmienne z dopasowań można podstawiać tylko w pierwszym parametrze i że o ile można RewriteCond’y połączyć wyrażeniami logicznymi typu AND/OR to nie ma możliwości porównania czy dopasowania z kolejnych RewriteCond’ów są identyczne....</p></div><footer class=entry-footer><span title='2012-09-09 00:00:00 +0000 UTC'>2012-09-09</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Apache: ograniczenie dostępu dla zalogowanych użytkowników z mod_rewrite i mod_auth_basic" href=https://gagor.pro/2012/09/apache-ograniczenie-dostepu-dla-zalogowanych-uzytkownikow-z-mod_rewrite-i-mod_auth_basic/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>unicode-rxvt - moje ustawienia</h2></header><div class=entry-content><p>Wybór dobrego X-terminala to w życiu admina prawie jak wybór żony… spędza się wspólnie dużo czasu i miło gdy estetycznie wygląda, robi to co chcemy, itd… 😉
Nie lubię gnome-terminal'a bo domyślnie binduje F10 co wnerwia mnie w midnight commanderze, stąd szukałem i szukałem i jak dotychczas najbardziej podpasował mi unicode-rxvt. Można uruchamiać go po prostu jako urxvt lub uruchomić demona urxvtd po zalogowaniu i potem odpalać tylko klienta urxvtc. Druga metoda skutkuje natychmiastowym startem terminala, wiec gdy podbinduję go sobie pod F12 mam terminal zawsze pod ręką w mniej niż sekundę....</p></div><footer class=entry-footer><span title='2012-09-09 00:00:00 +0000 UTC'>2012-09-09</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to unicode-rxvt - moje ustawienia" href=https://gagor.pro/2012/09/unicode-rxvt-moje-ustawienia/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Wymuszenie fsck po restarcie</h2></header><div class=entry-content><p>Jeżeli chcemy by po ponownym uruchomieniu w czasie startu zostały sprawdzone wszystkie dyski narzędziem to można to osiągnąć na dwa sposoby. Zawsze gdy tego potrzebuję zastanawiam się tylko jaki plik trzeba było utworzyć… forcefsck, fsck, fsckforce… więc notuję 😉
Utworzenie pliku /forcefsck Pierwsza metoda polega na utworzeniu pliku forcefsck w głównym katalog, robimy to poniższym poleceniem:
sudo touch /forcefsck Polecenie shutdown Druga metoda wykorzystuje parametr -F polecenia shutdown ale nie działa na wszystkich dystrybucjach (w takiej sytuacji patrz pierwsza metoda):...</p></div><footer class=entry-footer><span title='2012-09-08 00:00:00 +0000 UTC'>2012-09-08</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Wymuszenie fsck po restarcie" href=https://gagor.pro/2012/09/wymuszenie-fsck-po-restarcie/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Montowanie partycji z obrazu dysku</h2></header><div class=entry-content><p>Jedną z rzeczy, które podobają mi się w maszynach wirtualnych Xen jest możliwość zrobienia backupu całego obrazu i szybkie odzyskanie już w trakcie ciężkiej awarii. Gdy dodatkowo korzysta się z LVM’a to można na chwilę wyłączyć DomU, utworzyć snapshot jego dysków, uruchomić DomU i w trakcie działania robić spójny backup ze snapshot’a. Dzięki takiemu mechanizmowi serwer jest niedostępny przez kilkanaście sekund, a backup spójny jakby został wykonany przy całkowicie wyłączonej maszynie....</p></div><footer class=entry-footer><span title='2012-09-06 00:00:00 +0000 UTC'>2012-09-06</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Montowanie partycji z obrazu dysku" href=https://gagor.pro/2012/09/montowanie-partycji-z-obrazu-dysku/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>CouchDB - Instalacja i wstępna konfiguracja</h2></header><div class=entry-content><p>Gdy tworzymy pierwszą aplikację webową, która umożliwia upload plików przeważnie lądują one lokalnie w pewniej lokalizacji. Gdy druga aplikacja potrzebuje dostępu do tych plików wystarczy podać ścieżkę. Problemy zaczynają się gdy aplikacji jest kilka i rozmieszczonych na kilku serwerach. Można korzystać z sieciowych systemów plików ale to często nie jest zbyt wygodne - ciężko odpowiednio ustawić uprawnienia by pewne aplikacje miały dostęp do zapisu plików a inne nie, trzeba skonfigurować dany katalog w kilku miejscach w konfiguracji serwera WWW aby serwować pliki itp…...</p></div><footer class=entry-footer><span title='2012-06-08 00:00:00 +0000 UTC'>2012-06-08</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to CouchDB - Instalacja i wstępna konfiguracja" href=https://gagor.pro/2012/06/couchdb-instalacja-i-wstepna-konfiguracja/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Ponowne wygenerowanie kluczy serwera OpenSSH</h2></header><div class=entry-content><p>Czasami odpalam klona jakiegoś systemu by później po drobnych zmianach uczynić go osobnym bytem. Jednym z kroków po odtworzeniu systemu jest wygenerowanie nowego zestawu kluczy dla serwera OpenSSH (by mój klient ssh nie siał warning’ami). Można to wykonać tak:
Najpierw kasujemy obecne klucze:
rm /etc/ssh/ssh_host_* Teraz generujemy nowe:
dpkg-reconfigure openssh-server I na koniec restartujemy usługę by załadować nowy zestaw kluczy (nie powinno to zerwać obecnej sesji, ale dla pewności lepiej zadanie odpalić w screen’ie):...</p></div><footer class=entry-footer><span title='2012-02-27 00:00:00 +0000 UTC'>2012-02-27</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Ponowne wygenerowanie kluczy serwera OpenSSH" href=https://gagor.pro/2012/02/ponowne-wygenerowanie-kluczy-serwera-openssh/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Wstępne ładowanie programów przy starcie z ureadahead</h2></header><div class=entry-content><p>Jakiś czas temu korzystałem z preload’a  external link który sam uczył się jakie aplikacje odpalam i te programy ładował już podczas startu - przeważnie nieco spowalnia to start systemu ale gdy już się załaduje to programy, które uruchamiam jako pierwsze startują “z kopa”. Od jakiegoś czasu popularniejszy jest instalowany domyślnie w Ubuntu ureadahead - pełni on podobną funkcję jak preload.
Można zmusić ureadahead do ponownego wygenerowania nowej listy programów wczytywanych przy starcie do cache a oto jak zrobić:...</p></div><footer class=entry-footer><span title='2012-01-24 00:00:00 +0000 UTC'>2012-01-24</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Wstępne ładowanie programów przy starcie z ureadahead" href=https://gagor.pro/2012/01/wstepne-ladowanie-programow-przy-starcie-z-ureadahead/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Długie oczekiwanie na nawiązanie połączenia ssh</h2></header><div class=entry-content><p>Objaw przeważnie jest taki: łączysz się po ssh podając klucz/hasło i czekasz nawet i 10 sekund aż pojawi się prompt. Po połączeniu wszystkie polecenia działają z normalną szybkością. Brzmi znajomo? 😉
Taki objaw przeważnie jest skutkiem problemów z działaniem DNS’a po stronie klienta lub serwera. Warto sprawdzić poleceniami host/dig/nslookup po obu stronach jak dużo czasu potrzeba na rozwiązanie nazw. Najlepiej rozwiązać problem z DNS’em ustawiając szybkie serwery ale gdy nie mamy takiej możliwości to po stronie serwera można ustawić w /etc/sshd_config opcję:...</p></div><footer class=entry-footer><span title='2012-01-23 00:00:00 +0000 UTC'>2012-01-23</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Długie oczekiwanie na nawiązanie połączenia ssh" href=https://gagor.pro/2012/01/dlugie-oczekiwanie-na-nawiazanie-polaczenia-ssh/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>fail2ban - regułki dla dovecot’a</h2></header><div class=entry-content><p>Domyślna konfiguracja fail2ban’a (na Debianie) nie zawiera reguł pozwalających na blokowanie prób włamań na skrzynki POP/IMAP dla dovecota (no chyba że korzystamy z saslauthd). Można szybko utworzyć własny zestaw filtrów co przedstawię poniżej.
Tworzymy plik: /etc/fail2ban/filter.d/dovecot.conf
[Definition] failregex = (?: pop3-login|imap-login): .*(?:Authentication failure|Aborted login \(auth failed|Aborted login \(tried to use disabled|Disconnected \(auth failed|Aborted login \(\d+ authentication attempts).*rip=(?P&lt;host>\S*),.* ignoreregex = Później dopisujemy na końcu pliku: /etc/fail2ban/jail.conf
[dovecot] enabled = true filter = dovecot port = pop3,pop3s,imap,imaps logpath = /var/log/mail....</p></div><footer class=entry-footer><span title='2011-11-28 00:00:00 +0000 UTC'>2011-11-28</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to fail2ban - regułki dla dovecot’a" href=https://gagor.pro/2011/11/fail2ban-regulki-dla-dovecota/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://gagor.pro/tags/linux/page/8/>«&nbsp;Prev&nbsp;
</a><a class=next href=https://gagor.pro/tags/linux/page/10/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span><a href=https://gagor.pro/>Tom's Blog</a> &copy; 2008-2024</span>
<span>Content licensed under <a rel="license noopener noreferrer" target=_blank href=http://creativecommons.org/licenses/by-sa/4.0/>(CC BY-SA 4.0)</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>