<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>bash | Tom's Blog</title>
<meta name=keywords content><meta name=description content="pages for taxonomy (classification) term: bash"><meta name=author content="timor"><link rel=canonical href=/tags/bash/><link crossorigin=anonymous href=/assets/css/stylesheet.54d9f8673f7336b5aaf6aed1f553f58f41d018b0cf41d3fd49e352ff367f9312.css integrity="sha256-VNn4Zz9zNrWq9q7R9VP1j0HQGLDPQdP9SeNS/zZ/kxI=" rel="preload stylesheet" as=style><link rel=icon href=favicon.ico><link rel=icon type=image/png sizes=16x16 href=favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=favicon-32x32.png><link rel=apple-touch-icon href=apple-touch-icon.png><link rel=mask-icon href=safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=/tags/bash/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-4TQXK4C4W5"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4TQXK4C4W5",{anonymize_ip:!1})}</script><meta property="og:title" content="bash"><meta property="og:description" content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"><meta property="og:type" content="website"><meta property="og:url" content="/tags/bash/"><meta name=twitter:card content="summary"><meta name=twitter:title content="bash"><meta name=twitter:description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"></head><body class="list dark" id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href accesskey=h title="Tom's Blog (Alt + H)"><img src=https://gagor.pl/favicon-72x72.png alt aria-label=logo height=36>Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=/projects/ title=Projects><span>Projects</span></a></li><li><a href=/bookshelf/ title=Bookshelf><span>Bookshelf</span></a></li><li><a href=/archives/ title=Archive><span>Archive</span></a></li><li><a href=/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href>Home</a>&nbsp;»&nbsp;<a href=/tags/>Tags</a></div><h1>bash</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>How to stole ssh session when you’re root</h2></header><div class=entry-content><p>It happen to me all the time that one of developers notifies me about some kind of problem that I can’t confirm from my account. Sometimes it was because of bad ssh keys configuration, other times file permissions, mostly such stuff. It’s sometimes convenient to “enter into someone’s shoes” to see what’s going on there.
If you’re root on machine you may do that like this:
su developer - Easy one but that’s not enough for all cases....</p></div><footer class=entry-footer><span title='2016-04-27 00:00:00 +0000 UTC'>2016-04-27</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to How to stole ssh session when you’re root" href=/2016/04/how-to-stole-ssh-session-when-youre-root/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>pip - uninstall package with dependencies</h2></header><div class=entry-content><p>Virtualenvs in python are cheap but from time to time you will install something with pip on your system and when time comes removing all this crap could be difficult. I found this bash snippet that will uninstall package with all dependencies:
for dep in $(pip show python-neutronclient | grep Requires | sed 's/Requires: //g; s/,//g') ; do sudo pip uninstall -y $dep ; done pip uninstall -y python-neutronclient Source: http://stackoverflow....</p></div><footer class=entry-footer><span title='2016-04-26 00:00:00 +0000 UTC'>2016-04-26</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to pip - uninstall package with dependencies" href=/2016/04/pip-uninstall-package-with-dependencies/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Use bastion host with Ansible</h2></header><div class=entry-content><p>When you deploy your application in cloud you don’t need and don’t want your hosts exposed via SSH to the world. Malware scans whole network for easy SSH access and when find something will try some brute force attacks, overloading such machines. It’s easier to have one exposed, but secured host, that doesn’t host anything and is used as proxy/gateway to access our infrastructure- it’s called bastion host  external link ....</p></div><footer class=entry-footer><span title='2016-04-22 00:00:00 +0000 UTC'>2016-04-22</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Use bastion host with Ansible" href=/2016/04/use-bastion-host-with-ansible/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>List octal file permissions in bash</h2></header><div class=entry-content><p>Sometimes it’s easier to use octal file permissions but they’re not so easy to list. I caught myself few times that I didn’t remember how to list them - so this is a reason for that note.
stat -c "%a %n" * 755 bin 755 games 755 include Yes, it’s that easy 😃
And here also with human readable attributes:
stat -c '%A %a %n' * drwxr-xr-x 755 bin drwxr-xr-x 755 games drwxr-xr-x 755 include</p></div><footer class=entry-footer><span title='2016-02-24 00:00:00 +0000 UTC'>2016-02-24</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to List octal file permissions in bash" href=/2016/02/list-octal-file-permissions-in-bash/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Automatically build after file change</h2></header><div class=entry-content><p>I’m playing a lot with Docker lately. Building images, and then rebuilding, and then building again… It’s pretty boring. To automate this task a little I used inotify to build automatically after I changed any file. This trick could be used in many different situations.
You will need inotify-tools package:
sudo apt-get install -y inotify-tools Then run something like this:
while inotifywait -e modify -r .; do docker-compose build; done This commands will rebuild my Docker images after any file change in current directory....</p></div><footer class=entry-footer><span title='2016-02-23 00:00:00 +0000 UTC'>2016-02-23</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Automatically build after file change" href=/2016/02/automatically-build-after-file-change/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Install WordPress from command-line</h2></header><div class=entry-content><p>I never tried it before but today I needed to install WordPress… From command line only. And there is a way to do this with wp-cli  external link .
WP-CLI installation First some requirements (as root):
apt-get install php5-cli php5-mysql mysql-client curl And now installation of wp-cli (as root too):
curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar chmod +x wp-cli.phar mv wp-cli.phar /usr/local/bin/wp Check if it’s working:
$ wp --version WP-CLI 0.22.0 WordPress installation Now you should switch to user of your web application, ex....</p></div><footer class=entry-footer><span title='2016-02-15 00:00:00 +0000 UTC'>2016-02-15</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Install WordPress from command-line" href=/2016/02/install-wordpress-from-command-line/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Nagios - downtime on host/service from command line with curl</h2></header><div class=entry-content><p>Sometimes deployment process or other havy task may cause some Nagios checks to rise below normal levels and bother admin. If this is expected and you want to add downtime on host/service during this task you may use this script:
#!/bin/bash function die { echo $1; exit 1; } if [[ $# -eq 0 ]] ; then die "Give hostname and time in minutes as parameter!" fi if [[ $# -eq 1 ]] ; then MINUTES=15 else MINUTES=$2 fi HOST=$1 NAGURL=http://nagios....</p></div><footer class=entry-footer><span title='2016-01-11 00:00:00 +0000 UTC'>2016-01-11</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Nagios - downtime on host/service from command line with curl" href=/2016/01/nagios-downtime-on-hostservice-from-command-line-with-curl/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Changing default php.ini file for PHP-CLI on CentOS</h2></header><div class=entry-content><p>On Debian in default installation you have different configuration files for PHP in Apache, FPM, CLI, etc. But on CentOS you have only one php.ini for all of them. In case I have, I need to have different configuration file for scripts running in CLI mode (more memory, etc). I could run it like this:
php -c /etc/php-cli.ini script.php But this a little burdensome. So I do it like this:...</p></div><footer class=entry-footer><span title='2014-05-08 00:00:00 +0000 UTC'>2014-05-08</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Changing default php.ini file for PHP-CLI on CentOS" href=/2014/05/changing-default-php-ini-file-for-php-cli-on-centos/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Command to change root password</h2></header><div class=entry-content><p>Everybody knows passwd command but it’s useless when you need to change ex. root password from command line without waiting for input. In such case oneliner below could help:
echo "root:new_password" | chpasswd</p></div><footer class=entry-footer><span title='2014-05-08 00:00:00 +0000 UTC'>2014-05-08</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Command to change root password" href=/2014/05/command-to-change-root-password/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Comparing two lists in bash</h2></header><div class=entry-content><p>I had quite simple task - compare two lists of hosts and check if hosts from first one are also on the second one. I started with diff:
diff -u biglist.txt hosts_to_check.txt | grep -E "^\+" It was fine but output needs some filtering to get what I want.
I’ve found another example with grep:
grep -Fxv -f biglist.txt hosts_to_check.txt | sort -n This will search for all lines in hosts_to_check....</p></div><footer class=entry-footer><span title='2014-02-18 00:00:00 +0000 UTC'>2014-02-18</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Comparing two lists in bash" href=/2014/02/comparing-two-lists-in-bash/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=/tags/bash/>«&nbsp;Prev&nbsp;
</a><a class=next href=/tags/bash/page/3/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span><a href>Tom's Blog</a> &copy; 2008-2024</span>
<span>Content licensed under <a rel="license noopener noreferrer" target=_blank href=http://creativecommons.org/licenses/by-sa/4.0/>(CC BY-SA 4.0)</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>