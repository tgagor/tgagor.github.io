<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>bash | Tom's Blog</title>
<meta name=keywords content><meta name=description content="pages for taxonomy (classification) term: bash"><meta name=author content="timor"><link rel=canonical href=https://gagor.pro/tags/bash/><link crossorigin=anonymous href=/assets/css/stylesheet.54d9f8673f7336b5aaf6aed1f553f58f41d018b0cf41d3fd49e352ff367f9312.css integrity="sha256-VNn4Zz9zNrWq9q7R9VP1j0HQGLDPQdP9SeNS/zZ/kxI=" rel="preload stylesheet" as=style><link rel=icon href=https://gagor.pro/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://gagor.pro/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gagor.pro/favicon-32x32.png><link rel=apple-touch-icon href=https://gagor.pro/apple-touch-icon.png><link rel=mask-icon href=https://gagor.pro/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-4F5HJ7RNKM"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4F5HJ7RNKM",{anonymize_ip:!1})}</script><meta property="og:title" content="bash"><meta property="og:description" content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"><meta property="og:type" content="website"><meta property="og:url" content="https://gagor.pro/tags/bash/"><meta name=twitter:card content="summary"><meta name=twitter:title content="bash"><meta name=twitter:description content="Linux configuration, Automation, Security - Sysadmin/DevOps blog"></head><body class="list dark" id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://gagor.pro/ accesskey=h title="Tom's Blog (Alt + H)"><img src=https://gagor.pro/favicon-72x72.png alt aria-label=logo height=36>Tom's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://gagor.pro/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://gagor.pro/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://gagor.pro/bookshelf/ title=Bookshelf><span>Bookshelf</span></a></li><li><a href=https://gagor.pro/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://gagor.pro/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://gagor.pro/>Home</a>&nbsp;»&nbsp;<a href=https://gagor.pro/tags/>Tags</a></div><h1>bash</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Comparing two lists in bash</h2></header><div class=entry-content><p>I had quite simple task - compare two lists of hosts and check if hosts from first one are also on the second one. I started with diff:
diff -u biglist.txt hosts_to_check.txt | grep -E "^\+" It was fine but output needs some filtering to get what I want.
I’ve found another example with grep:
grep -Fxv -f biglist.txt hosts_to_check.txt | sort -n This will search for all lines in hosts_to_check....</p></div><footer class=entry-footer><span title='2014-02-18 00:00:00 +0000 UTC'>2014-02-18</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Comparing two lists in bash" href=https://gagor.pro/2014/02/comparing-two-lists-in-bash/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Regenerate thumbnails in Shotwell 0.15 (for last month)</h2></header><div class=entry-content><p>I love Shotwell  external link for it’s simplicity and easy export to Piwigo  external link . After Christmas I added new photos to my library but after that I made some modifications to them (red eye reduction, etc…). Because Shotwell generate thumbnails only on import, all my modifications were not visible on preview.
I’ve started searching how to regenerate thumbs and found this info  external link . There were two issues with this method:...</p></div><footer class=entry-footer><span title='2014-01-08 00:00:00 +0000 UTC'>2014-01-08</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Regenerate thumbnails in Shotwell 0.15 (for last month)" href=https://gagor.pro/2014/01/regenerate-thumbnails-in-shotwell-for-last-month/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Debian - zablokowanie aktualizacji pakietu</h2></header><div class=entry-content><p>W teorii nie powinno się blokować aktualizacji pakietów bo łatają dziury itd…. Ale! Zdarzyły mi się ostatnio dwie sytuacje, które do tego mnie zmusiły:
aktualizacja hudsona kończyła się błędem przy starcie usługi, aktualizacja domU Xen skończyła się problemem z kompatybilnością mechanizmu udev w systemie i jądrze (hypervisor miał starsze jądro niż spodziewało się DomU). W takich sytuacjach bardzo przydaje się możliwość zablokowania aktualizacji jednej “psującej” paczki na pewien okres czasu by nie opóźniać innych aktualizacji a sobie dać czas na rozpracowanie problemu....</p></div><footer class=entry-footer><span title='2013-11-05 00:00:00 +0000 UTC'>2013-11-05</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Debian - zablokowanie aktualizacji pakietu" href=https://gagor.pro/2013/11/debian-zablokowanie-aktualizacji-pakietu/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Kopiowanie wolumenów LVM z dd i netcat</h2></header><div class=entry-content><p>Niedawno chciałem skopiować maszynę wirtualną z jednego hypervisora na innego. Były to 3 wolumeny LVM o rozmiarach od 50 do 100GB. Dawno temu zrobiłem sobie skrypty do backupu - jeden kompresuje wolumeny LVM - a drugi pozwala odtworzyć z dekompresja na drugim serwerze. Tyle że przy tak dużej maszynce będzie to trwało masakrycznie długo - fajnie byłoby móc równocześnie kopiować i odtwarzać (live)…
I wtedy przypomniało mi się narzędzie netcat - zrobiłem snapshoty wolumenów i mogłem zaczynać....</p></div><footer class=entry-footer><span title='2013-09-02 00:00:00 +0000 UTC'>2013-09-02</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Kopiowanie wolumenów LVM z dd i netcat" href=https://gagor.pro/2013/09/kopiowanie-wolumenow-lvm-z-dd-i-netcat/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Tworzenie patch’y z poleceniami diff i patch</h2></header><div class=entry-content><p>Jest kilka powodów dla których tworzenie patchy jest przydatne - jeśli tu jesteś to pewnie masz jakiś własny…
Tworzenie patch’a diff -crB old new > from-old-to-new.patch W powyższym poleceniu założyłem że old i new to katalogi z wieloma podkatalogami i plikami - stąd opcja -r. -c dodaje kilka linijek “kontekstu” przez co łatwiej rozeznać się w patch’u. Opcja -B ignoruje puste linie, których patchowanie mnie nie interesuje.
Patchowanie Na początek zawsze warto wywołać polecenie z opcją -dry-run by zobaczyć czy patch wykona się poprawnie:...</p></div><footer class=entry-footer><span title='2013-04-01 00:00:00 +0000 UTC'>2013-04-01</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Tworzenie patch’y z poleceniami diff i patch" href=https://gagor.pro/2013/04/tworzenie-patchy-z-poleceniami-diff-i-patch/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Rozsynchronizowane serwery NTP</h2></header><div class=entry-content><p>Miałem ostatnio zabawną sytuację gdy kilka serwerów z zainstalowanym NTPD miało rozjazdy rzędu kilkunastu sekund. Wyszło na to że moje serwery synchronizowały się z różnymi zewnętrznymi serwerami NTP pomiędzy, którymi były rozjazdy i te rozjazdy synchronizowały się na moich serwerach. Jeden “z moich” ustanowiłem głównym a wszystkie inne przekierowałem na niego (komentując wszystkie inne serwery NTP w konfiguracji). Wymusiłem synchronizację:
ntp -q Sprawdziłem jak duży jest offset i jitter (powinny być bardzo małe):...</p></div><footer class=entry-footer><span title='2013-03-31 00:00:00 +0000 UTC'>2013-03-31</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Rozsynchronizowane serwery NTP" href=https://gagor.pro/2013/03/rozsynchronizowane-serwery-ntp/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Linux - naprawianie bad sectorów</h2></header><div class=entry-content><p>Dyski się zużywają i w końcu wcześniej czy później pojawiają się na nich bad sectory. Jeden z moich dysków ciut się posypał a że służy wyłącznie do backupów to mogę z tym żyć. Ale z drugiej strony jeżeli już będę musiał sięgnąć do backupów to chcę mieć pewność że coś odzyskam, dlatego postanowiłem zrobić kilka testów. Nawet jeśli nie naprawi to sektorów to przynajmniej zostaną zaznaczone jako uszkodzone i realokowane....</p></div><footer class=entry-footer><span title='2012-12-27 00:00:00 +0000 UTC'>2012-12-27</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Linux - naprawianie bad sectorów" href=https://gagor.pro/2012/12/linux-naprawianie-bad-sectorow/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Nginx - kompresowanie plików dla gzip_static</h2></header><div class=entry-content><p>Ruski serwer WWW  external link ma przydatną funkcję serwowania wersji plików skompresowanych gzip’em - przez co możemy plik skompresować raz i będzie on serwowany klientom obsługującym kompresję HTTP ale już bez każdorazowego kompresowania go. Jest to bardzo przydatne na stronach z dużym ruchem gdzie można w ten sposób zaoszczędzić takty CPU na właściwą obsługę połączeń a nie kompresję. Drugie miejsce gdzie może to być przydatne to VPS’y i “cienkie” serwery, które na kompresji przy większym obciążeniu spędzają zbyt dużo czasu i daje się to odczuć w działaniu strony....</p></div><footer class=entry-footer><span title='2012-12-17 00:00:00 +0000 UTC'>2012-12-17</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to Nginx - kompresowanie plików dla gzip_static" href=https://gagor.pro/2012/12/nginx-kompresowanie-plikow-dla-gzip_static/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>ldapsearch w Active Directory</h2></header><div class=entry-content><p>Można lubieć AD, można go nie lubieć… Ale jak już się ma to warto czasem zintegrować go z tym… i tamtym… Od strony Linuksa najwygodniej można to osiągnąć przez LDAP. A żeby to dobrze zrobić trzeba najpierw przetestować czy aby wszystko działa jak byśmy sobie tego życzyli. I tutaj bardzo przydatne jest narzędzie ldapsearch.
Do odpytywania LDAP’a potrzebujemy jeden pakiecik, który zawiera kilka narzędzi do jego obsługi:
apt-get install ldap-utils Teraz możemy próbować przeszukiwać katalog np....</p></div><footer class=entry-footer><span title='2012-12-05 00:00:00 +0000 UTC'>2012-12-05</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to ldapsearch w Active Directory" href=https://gagor.pro/2012/12/ldapsearch-w-active-directory/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>LVM na RAID5 i dysku z sektorami 4KB</h2></header><div class=entry-content><p>Po zakupie nowych dysków zamierzam utworzyć zdegradowaną macierz RAID5 z dwóch dysków (na trzecim na razie znajdują się dane), potem utworzyć wolumen LVM, sformatować go, przekopiować dane z pojedynczego dysku na macierz i dołączyć trzeci dysk do macierzy odbudowując parzystość. Zadanie będzie o tyle ciekawe że dysk ma 4KB sektory i trzeb będzie dbać o wyrównanie zasobu do rozmiaru sektora, a w przypadku LVM’a wyrównanie do chunk’a z macierzy.
Prawidłowe wyrównanie partycji Kupując nowy dysk (o pojemności od 500GB w górę), mamy spore szanse że trafimy na sztukę, która wykorzystuje 4KB sektory do alokacji danych....</p></div><footer class=entry-footer><span title='2012-11-07 00:00:00 +0000 UTC'>2012-11-07</span>&nbsp;·&nbsp;15 min&nbsp;·&nbsp;timor</footer><a class=entry-link aria-label="post link to LVM na RAID5 i dysku z sektorami 4KB" href=https://gagor.pro/2012/11/lvm-na-raid5-i-dysku-z-sektorami-4kb/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://gagor.pro/tags/bash/page/2/>«&nbsp;Prev&nbsp;
</a><a class=next href=https://gagor.pro/tags/bash/page/4/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span><a href=https://gagor.pro/>Tom's Blog</a> &copy; 2008-2024</span>
<span>Content licensed under <a rel="license noopener noreferrer" target=_blank href=http://creativecommons.org/licenses/by-sa/4.0/>(CC BY-SA 4.0)</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>